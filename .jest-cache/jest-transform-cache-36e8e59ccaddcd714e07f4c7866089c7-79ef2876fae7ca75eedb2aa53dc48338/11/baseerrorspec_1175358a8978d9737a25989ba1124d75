6d4f7eea41d0d428155ee8d6e3dc78dc
"use strict";
/**
 * Unit Tests: Custom Error Classes
 *
 * Testing custom error implementations
 */
Object.defineProperty(exports, "__esModule", { value: true });
const base_error_1 = require("./base.error");
describe('Custom Error Classes', () => {
    describe('BaseError', () => {
        class TestError extends base_error_1.BaseError {
            constructor(message) {
                super(message, 418);
            }
        }
        it('should create error with correct properties', () => {
            const error = new TestError('Test error');
            expect(error.message).toBe('Test error');
            expect(error.statusCode).toBe(418);
            expect(error.isOperational).toBe(true);
            expect(error.timestamp).toBeInstanceOf(Date);
        });
        it('should have proper stack trace', () => {
            const error = new TestError('Test error');
            expect(error.stack).toBeDefined();
            expect(error.stack).toContain('Test error');
            expect(error.stack).toContain('base.error.spec.ts');
        });
        it('should serialize to JSON correctly', () => {
            const error = new TestError('Test error');
            const json = error.toJSON();
            expect(json).toMatchObject({
                error: 'TestError',
                message: 'Test error',
                statusCode: 418,
            });
            expect(json.timestamp).toBeDefined();
        });
    });
    describe('BadRequestError', () => {
        it('should have status code 400', () => {
            const error = new base_error_1.BadRequestError('Invalid input');
            expect(error.statusCode).toBe(400);
            expect(error.message).toBe('Invalid input');
        });
        it('should use default message', () => {
            const error = new base_error_1.BadRequestError();
            expect(error.message).toBe('Bad Request');
        });
    });
    describe('UnauthorizedError', () => {
        it('should have status code 401', () => {
            const error = new base_error_1.UnauthorizedError('Not authenticated');
            expect(error.statusCode).toBe(401);
            expect(error.message).toBe('Not authenticated');
        });
        it('should use default message', () => {
            const error = new base_error_1.UnauthorizedError();
            expect(error.message).toBe('Unauthorized');
        });
    });
    describe('ForbiddenError', () => {
        it('should have status code 403', () => {
            const error = new base_error_1.ForbiddenError('Access denied');
            expect(error.statusCode).toBe(403);
            expect(error.message).toBe('Access denied');
        });
    });
    describe('NotFoundError', () => {
        it('should have status code 404', () => {
            const error = new base_error_1.NotFoundError('User not found');
            expect(error.statusCode).toBe(404);
            expect(error.message).toBe('User not found');
        });
    });
    describe('ConflictError', () => {
        it('should have status code 409', () => {
            const error = new base_error_1.ConflictError('Email already exists');
            expect(error.statusCode).toBe(409);
            expect(error.message).toBe('Email already exists');
        });
    });
    describe('ValidationError', () => {
        it('should have status code 422', () => {
            const errors = {
                email: ['Invalid email format'],
                password: ['Password too short'],
            };
            const error = new base_error_1.ValidationError('Validation failed', errors);
            expect(error.statusCode).toBe(422);
            expect(error.errors).toEqual(errors);
        });
        it('should include errors in JSON', () => {
            const errors = { field: ['error'] };
            const error = new base_error_1.ValidationError('Validation failed', errors);
            const json = error.toJSON();
            expect(json.errors).toEqual(errors);
        });
    });
    describe('RateLimitError', () => {
        it('should have status code 429', () => {
            const error = new base_error_1.RateLimitError('Too many requests');
            expect(error.statusCode).toBe(429);
        });
    });
    describe('InternalServerError', () => {
        it('should have status code 500', () => {
            const error = new base_error_1.InternalServerError('Server error');
            expect(error.statusCode).toBe(500);
        });
        it('should not be operational', () => {
            const error = new base_error_1.InternalServerError();
            expect(error.isOperational).toBe(false);
        });
    });
    describe('ServiceUnavailableError', () => {
        it('should have status code 503', () => {
            const error = new base_error_1.ServiceUnavailableError('Service down');
            expect(error.statusCode).toBe(503);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXEFkYXB0aXZlX1Rlc3RpbmdcXHNyY1xcbGlic1xcZXJyb3JzXFxiYXNlLmVycm9yLnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7O0dBSUc7O0FBRUgsNkNBV3NCO0FBRXRCLFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7SUFDcEMsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7UUFDekIsTUFBTSxTQUFVLFNBQVEsc0JBQVM7WUFDL0IsWUFBWSxPQUFlO2dCQUN6QixLQUFLLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQ3RCLENBQUM7U0FDRjtRQUVELEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsTUFBTSxLQUFLLEdBQUcsSUFBSSxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFMUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDL0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1lBQ3hDLE1BQU0sS0FBSyxHQUFHLElBQUksU0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRTFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENB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QUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBQ3ZDLEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7WUFDckMsTUFBTSxLQUFLLEdBQUcsSUFBSSxvQ0FBdUIsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUUxRCxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXEFkYXB0aXZlX1Rlc3RpbmdcXHNyY1xcbGlic1xcZXJyb3JzXFxiYXNlLmVycm9yLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IFRlc3RzOiBDdXN0b20gRXJyb3IgQ2xhc3Nlc1xuICpcbiAqIFRlc3RpbmcgY3VzdG9tIGVycm9yIGltcGxlbWVudGF0aW9uc1xuICovXG5cbmltcG9ydCB7XG4gIEJhc2VFcnJvcixcbiAgQmFkUmVxdWVzdEVycm9yLFxuICBVbmF1dGhvcml6ZWRFcnJvcixcbiAgRm9yYmlkZGVuRXJyb3IsXG4gIE5vdEZvdW5kRXJyb3IsXG4gIENvbmZsaWN0RXJyb3IsXG4gIFZhbGlkYXRpb25FcnJvcixcbiAgUmF0ZUxpbWl0RXJyb3IsXG4gIEludGVybmFsU2VydmVyRXJyb3IsXG4gIFNlcnZpY2VVbmF2YWlsYWJsZUVycm9yLFxufSBmcm9tICcuL2Jhc2UuZXJyb3InO1xuXG5kZXNjcmliZSgnQ3VzdG9tIEVycm9yIENsYXNzZXMnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdCYXNlRXJyb3InLCAoKSA9PiB7XG4gICAgY2xhc3MgVGVzdEVycm9yIGV4dGVuZHMgQmFzZUVycm9yIHtcbiAgICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICBzdXBlcihtZXNzYWdlLCA0MTgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGVycm9yIHdpdGggY29ycmVjdCBwcm9wZXJ0aWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVGVzdEVycm9yKCdUZXN0IGVycm9yJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdUZXN0IGVycm9yJyk7XG4gICAgICBleHBlY3QoZXJyb3Iuc3RhdHVzQ29kZSkudG9CZSg0MTgpO1xuICAgICAgZXhwZWN0KGVycm9yLmlzT3BlcmF0aW9uYWwpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZXJyb3IudGltZXN0YW1wKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBwcm9wZXIgc3RhY2sgdHJhY2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBUZXN0RXJyb3IoJ1Rlc3QgZXJyb3InKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnN0YWNrKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGVycm9yLnN0YWNrKS50b0NvbnRhaW4oJ1Rlc3QgZXJyb3InKTtcbiAgICAgIGV4cGVjdChlcnJvci5zdGFjaykudG9Db250YWluKCdiYXNlLmVycm9yLnNwZWMudHMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2VyaWFsaXplIHRvIEpTT04gY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVGVzdEVycm9yKCdUZXN0IGVycm9yJyk7XG4gICAgICBjb25zdCBqc29uID0gZXJyb3IudG9KU09OKCk7XG5cbiAgICAgIGV4cGVjdChqc29uKS50b01hdGNoT2JqZWN0KHtcbiAgICAgICAgZXJyb3I6ICdUZXN0RXJyb3InLFxuICAgICAgICBtZXNzYWdlOiAnVGVzdCBlcnJvcicsXG4gICAgICAgIHN0YXR1c0NvZGU6IDQxOCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KGpzb24udGltZXN0YW1wKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQmFkUmVxdWVzdEVycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBzdGF0dXMgY29kZSA0MDAnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBCYWRSZXF1ZXN0RXJyb3IoJ0ludmFsaWQgaW5wdXQnKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnN0YXR1c0NvZGUpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdJbnZhbGlkIGlucHV0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBkZWZhdWx0IG1lc3NhZ2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBCYWRSZXF1ZXN0RXJyb3IoKTtcblxuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVbmF1dGhvcml6ZWRFcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgc3RhdHVzIGNvZGUgNDAxJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVW5hdXRob3JpemVkRXJyb3IoJ05vdCBhdXRoZW50aWNhdGVkJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDQwMSk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnTm90IGF1dGhlbnRpY2F0ZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIGRlZmF1bHQgbWVzc2FnZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFVuYXV0aG9yaXplZEVycm9yKCk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdVbmF1dGhvcml6ZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ZvcmJpZGRlbkVycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBzdGF0dXMgY29kZSA0MDMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBGb3JiaWRkZW5FcnJvcignQWNjZXNzIGRlbmllZCcpO1xuXG4gICAgICBleHBlY3QoZXJyb3Iuc3RhdHVzQ29kZSkudG9CZSg0MDMpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0FjY2VzcyBkZW5pZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05vdEZvdW5kRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDQwNCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IE5vdEZvdW5kRXJyb3IoJ1VzZXIgbm90IGZvdW5kJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDQwNCk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnVXNlciBub3QgZm91bmQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbmZsaWN0RXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDQwOScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IENvbmZsaWN0RXJyb3IoJ0VtYWlsIGFscmVhZHkgZXhpc3RzJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDQwOSk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnRW1haWwgYWxyZWFkeSBleGlzdHMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ZhbGlkYXRpb25FcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgc3RhdHVzIGNvZGUgNDIyJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3JzID0ge1xuICAgICAgICBlbWFpbDogWydJbnZhbGlkIGVtYWlsIGZvcm1hdCddLFxuICAgICAgICBwYXNzd29yZDogWydQYXNzd29yZCB0b28gc2hvcnQnXSxcbiAgICAgIH07XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ1ZhbGlkYXRpb24gZmFpbGVkJywgZXJyb3JzKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnN0YXR1c0NvZGUpLnRvQmUoNDIyKTtcbiAgICAgIGV4cGVjdChlcnJvci5lcnJvcnMpLnRvRXF1YWwoZXJyb3JzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBlcnJvcnMgaW4gSlNPTicsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9ycyA9IHsgZmllbGQ6IFsnZXJyb3InXSB9O1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVmFsaWRhdGlvbkVycm9yKCdWYWxpZGF0aW9uIGZhaWxlZCcsIGVycm9ycyk7XG4gICAgICBjb25zdCBqc29uID0gZXJyb3IudG9KU09OKCk7XG5cbiAgICAgIGV4cGVjdChqc29uLmVycm9ycykudG9FcXVhbChlcnJvcnMpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmF0ZUxpbWl0RXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDQyOScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFJhdGVMaW1pdEVycm9yKCdUb28gbWFueSByZXF1ZXN0cycpO1xuXG4gICAgICBleHBlY3QoZXJyb3Iuc3RhdHVzQ29kZSkudG9CZSg0MjkpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZXJuYWxTZXJ2ZXJFcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgc3RhdHVzIGNvZGUgNTAwJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvcignU2VydmVyIGVycm9yJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDUwMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBiZSBvcGVyYXRpb25hbCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEludGVybmFsU2VydmVyRXJyb3IoKTtcblxuICAgICAgZXhwZWN0KGVycm9yLmlzT3BlcmF0aW9uYWwpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VydmljZVVuYXZhaWxhYmxlRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDUwMycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFNlcnZpY2VVbmF2YWlsYWJsZUVycm9yKCdTZXJ2aWNlIGRvd24nKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnN0YXR1c0NvZGUpLnRvQmUoNTAzKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==