bedbe527f09a54a1bc019395af81c0b4
"use strict";
/**
 * Unit Tests: Custom Error Classes
 *
 * Testing custom error implementations
 */
Object.defineProperty(exports, "__esModule", { value: true });
const base_error_1 = require("./base.error");
describe('Custom Error Classes', () => {
    describe('BaseError', () => {
        class TestError extends base_error_1.BaseError {
            constructor(message) {
                super(message, 418);
            }
        }
        it('should create error with correct properties', () => {
            const error = new TestError('Test error');
            expect(error.message).toBe('Test error');
            expect(error.statusCode).toBe(418);
            expect(error.isOperational).toBe(true);
            expect(error.timestamp).toBeInstanceOf(Date);
        });
        it('should have proper stack trace', () => {
            const error = new TestError('Test error');
            expect(error.stack).toBeDefined();
            expect(error.stack).toContain('TestError');
        });
        it('should serialize to JSON correctly', () => {
            const error = new TestError('Test error');
            const json = error.toJSON();
            expect(json).toMatchObject({
                error: 'TestError',
                message: 'Test error',
                statusCode: 418,
            });
            expect(json.timestamp).toBeDefined();
        });
    });
    describe('BadRequestError', () => {
        it('should have status code 400', () => {
            const error = new base_error_1.BadRequestError('Invalid input');
            expect(error.statusCode).toBe(400);
            expect(error.message).toBe('Invalid input');
        });
        it('should use default message', () => {
            const error = new base_error_1.BadRequestError();
            expect(error.message).toBe('Bad Request');
        });
    });
    describe('UnauthorizedError', () => {
        it('should have status code 401', () => {
            const error = new base_error_1.UnauthorizedError('Not authenticated');
            expect(error.statusCode).toBe(401);
            expect(error.message).toBe('Not authenticated');
        });
        it('should use default message', () => {
            const error = new base_error_1.UnauthorizedError();
            expect(error.message).toBe('Unauthorized');
        });
    });
    describe('ForbiddenError', () => {
        it('should have status code 403', () => {
            const error = new base_error_1.ForbiddenError('Access denied');
            expect(error.statusCode).toBe(403);
            expect(error.message).toBe('Access denied');
        });
    });
    describe('NotFoundError', () => {
        it('should have status code 404', () => {
            const error = new base_error_1.NotFoundError('User not found');
            expect(error.statusCode).toBe(404);
            expect(error.message).toBe('User not found');
        });
    });
    describe('ConflictError', () => {
        it('should have status code 409', () => {
            const error = new base_error_1.ConflictError('Email already exists');
            expect(error.statusCode).toBe(409);
            expect(error.message).toBe('Email already exists');
        });
    });
    describe('ValidationError', () => {
        it('should have status code 422', () => {
            const errors = {
                email: ['Invalid email format'],
                password: ['Password too short'],
            };
            const error = new base_error_1.ValidationError('Validation failed', errors);
            expect(error.statusCode).toBe(422);
            expect(error.errors).toEqual(errors);
        });
        it('should include errors in JSON', () => {
            const errors = { field: ['error'] };
            const error = new base_error_1.ValidationError('Validation failed', errors);
            const json = error.toJSON();
            expect(json.errors).toEqual(errors);
        });
    });
    describe('RateLimitError', () => {
        it('should have status code 429', () => {
            const error = new base_error_1.RateLimitError('Too many requests');
            expect(error.statusCode).toBe(429);
        });
    });
    describe('InternalServerError', () => {
        it('should have status code 500', () => {
            const error = new base_error_1.InternalServerError('Server error');
            expect(error.statusCode).toBe(500);
        });
        it('should not be operational', () => {
            const error = new base_error_1.InternalServerError();
            expect(error.isOperational).toBe(false);
        });
    });
    describe('ServiceUnavailableError', () => {
        it('should have status code 503', () => {
            const error = new base_error_1.ServiceUnavailableError('Service down');
            expect(error.statusCode).toBe(503);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXEFkYXB0aXZlX1Rlc3RpbmdcXHNyY1xcbGlic1xcZXJyb3JzXFxiYXNlLmVycm9yLnNwZWMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7O0dBSUc7O0FBRUgsNkNBV3NCO0FBRXRCLFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7SUFDcEMsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7UUFDekIsTUFBTSxTQUFVLFNBQVEsc0JBQVM7WUFDL0IsWUFBWSxPQUFlO2dCQUN6QixLQUFLLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQ3RCLENBQUM7U0FDRjtRQUVELEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsTUFBTSxLQUFLLEdBQUcsSUFBSSxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFMUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDL0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1lBQ3hDLE1BQU0sS0FBSyxHQUFHLElBQUksU0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRTFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDN0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO1lBQzVDLE1BQU0sS0FBSyxHQUFHLElBQUksU0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQzFDLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUU1QixNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsYUFBYSxDQUFDO2dCQUN6QixLQUFLLEVBQUUsV0FBVztnQkFDbEIsT0FBTyxFQUFFLFlBQVk7Z0JBQ3JCLFVBQVUsRUFBRSxHQUFHO2FBQ2hCLENBQUMsQ0FBQztZQUNILE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDdkMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLEtBQUssR0FBRyxJQUFJLDRCQUFlLENBQUMsZUFBZSxDQUFDLENBQUM7WUFFbkQsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1lBQ3BDLE1BQU0sS0FBSyxHQUFHLElBQUksNEJBQWUsRUFBRSxDQUFDO1lBRXBDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO1FBQ2pDLEVBQUUsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7WUFDckMsTUFBTSxLQUFLLEdBQUcsSUFBSSw4QkFBaUIsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBRXpELE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1lBQ3BDLE1BQU0sS0FBSyxHQUFHLElBQUksOEJBQWlCLEVBQUUsQ0FBQztZQUV0QyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1lBQ3JDLE1BQU0sS0FBSyxHQUFHLElBQUksMkJBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUVsRCxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNuQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUM5QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFDN0IsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLEtBQUssR0FBRyxJQUFJLDBCQUFhLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUVsRCxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNuQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQy9DLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUM3QixFQUFFLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1lBQ3JDLE1BQU0sS0FBSyxHQUFHLElBQUksMEJBQWEsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1lBRXhELE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFDckQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLE1BQU0sR0FBRztnQkFDYixLQUFLLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQztnQkFDL0IsUUFBUSxFQUFFLENBQUMsb0JBQW9CLENBQUM7YUFDakMsQ0FBQztZQUNGLE1BQU0sS0FBSyxHQUFHLElBQUksNEJBQWUsQ0FBQyxtQkFBbUIsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUUvRCxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNuQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7WUFDdkMsTUFBTSxNQUFNLEdBQUcsRUFBRSxLQUFLLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1lBQ3BDLE1BQU0sS0FBSyxHQUFHLElBQUksNEJBQWUsQ0FBQyxtQkFBbUIsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUMvRCxNQUFNLElBQUksR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7WUFFNUIsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLEtBQUssR0FBRyxJQUFJLDJCQUFjLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUV0RCxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtRQUNuQyxFQUFFLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1lBQ3JDLE1BQU0sS0FBSyxHQUFHLElBQUksZ0NBQW1CLENBQUMsY0FBYyxDQUFDLENBQUM7WUFFdEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDckMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO1lBQ25DLE1BQU0sS0FBSyxHQUFHLElBQUksZ0NBQW1CLEVBQUUsQ0FBQztZQUV4QyxNQUFNLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMxQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtRQUN2QyxFQUFFLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1lBQ3JDLE1BQU0sS0FBSyxHQUFHLElBQUksb0NBQXVCLENBQUMsY0FBYyxDQUFDLENBQUM7WUFFMUQsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDckMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxBZGFwdGl2ZV9UZXN0aW5nXFxzcmNcXGxpYnNcXGVycm9yc1xcYmFzZS5lcnJvci5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVW5pdCBUZXN0czogQ3VzdG9tIEVycm9yIENsYXNzZXNcbiAqXG4gKiBUZXN0aW5nIGN1c3RvbSBlcnJvciBpbXBsZW1lbnRhdGlvbnNcbiAqL1xuXG5pbXBvcnQge1xuICBCYXNlRXJyb3IsXG4gIEJhZFJlcXVlc3RFcnJvcixcbiAgVW5hdXRob3JpemVkRXJyb3IsXG4gIEZvcmJpZGRlbkVycm9yLFxuICBOb3RGb3VuZEVycm9yLFxuICBDb25mbGljdEVycm9yLFxuICBWYWxpZGF0aW9uRXJyb3IsXG4gIFJhdGVMaW1pdEVycm9yLFxuICBJbnRlcm5hbFNlcnZlckVycm9yLFxuICBTZXJ2aWNlVW5hdmFpbGFibGVFcnJvcixcbn0gZnJvbSAnLi9iYXNlLmVycm9yJztcblxuZGVzY3JpYmUoJ0N1c3RvbSBFcnJvciBDbGFzc2VzJywgKCkgPT4ge1xuICBkZXNjcmliZSgnQmFzZUVycm9yJywgKCkgPT4ge1xuICAgIGNsYXNzIFRlc3RFcnJvciBleHRlbmRzIEJhc2VFcnJvciB7XG4gICAgICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSwgNDE4KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBlcnJvciB3aXRoIGNvcnJlY3QgcHJvcGVydGllcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFRlc3RFcnJvcignVGVzdCBlcnJvcicpO1xuXG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnVGVzdCBlcnJvcicpO1xuICAgICAgZXhwZWN0KGVycm9yLnN0YXR1c0NvZGUpLnRvQmUoNDE4KTtcbiAgICAgIGV4cGVjdChlcnJvci5pc09wZXJhdGlvbmFsKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGVycm9yLnRpbWVzdGFtcCkudG9CZUluc3RhbmNlT2YoRGF0ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIHN0YWNrIHRyYWNlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVGVzdEVycm9yKCdUZXN0IGVycm9yJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGFjaykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChlcnJvci5zdGFjaykudG9Db250YWluKCdUZXN0RXJyb3InKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2VyaWFsaXplIHRvIEpTT04gY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVGVzdEVycm9yKCdUZXN0IGVycm9yJyk7XG4gICAgICBjb25zdCBqc29uID0gZXJyb3IudG9KU09OKCk7XG5cbiAgICAgIGV4cGVjdChqc29uKS50b01hdGNoT2JqZWN0KHtcbiAgICAgICAgZXJyb3I6ICdUZXN0RXJyb3InLFxuICAgICAgICBtZXNzYWdlOiAnVGVzdCBlcnJvcicsXG4gICAgICAgIHN0YXR1c0NvZGU6IDQxOCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KGpzb24udGltZXN0YW1wKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQmFkUmVxdWVzdEVycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBzdGF0dXMgY29kZSA0MDAnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBCYWRSZXF1ZXN0RXJyb3IoJ0ludmFsaWQgaW5wdXQnKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnN0YXR1c0NvZGUpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdJbnZhbGlkIGlucHV0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBkZWZhdWx0IG1lc3NhZ2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBCYWRSZXF1ZXN0RXJyb3IoKTtcblxuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVbmF1dGhvcml6ZWRFcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgc3RhdHVzIGNvZGUgNDAxJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVW5hdXRob3JpemVkRXJyb3IoJ05vdCBhdXRoZW50aWNhdGVkJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDQwMSk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnTm90IGF1dGhlbnRpY2F0ZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIGRlZmF1bHQgbWVzc2FnZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFVuYXV0aG9yaXplZEVycm9yKCk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50b0JlKCdVbmF1dGhvcml6ZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ZvcmJpZGRlbkVycm9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBzdGF0dXMgY29kZSA0MDMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBGb3JiaWRkZW5FcnJvcignQWNjZXNzIGRlbmllZCcpO1xuXG4gICAgICBleHBlY3QoZXJyb3Iuc3RhdHVzQ29kZSkudG9CZSg0MDMpO1xuICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvQmUoJ0FjY2VzcyBkZW5pZWQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05vdEZvdW5kRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDQwNCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IE5vdEZvdW5kRXJyb3IoJ1VzZXIgbm90IGZvdW5kJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDQwNCk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnVXNlciBub3QgZm91bmQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbmZsaWN0RXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDQwOScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IENvbmZsaWN0RXJyb3IoJ0VtYWlsIGFscmVhZHkgZXhpc3RzJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDQwOSk7XG4gICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG9CZSgnRW1haWwgYWxyZWFkeSBleGlzdHMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ZhbGlkYXRpb25FcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgc3RhdHVzIGNvZGUgNDIyJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3JzID0ge1xuICAgICAgICBlbWFpbDogWydJbnZhbGlkIGVtYWlsIGZvcm1hdCddLFxuICAgICAgICBwYXNzd29yZDogWydQYXNzd29yZCB0b28gc2hvcnQnXSxcbiAgICAgIH07XG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ1ZhbGlkYXRpb24gZmFpbGVkJywgZXJyb3JzKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnN0YXR1c0NvZGUpLnRvQmUoNDIyKTtcbiAgICAgIGV4cGVjdChlcnJvci5lcnJvcnMpLnRvRXF1YWwoZXJyb3JzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBlcnJvcnMgaW4gSlNPTicsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9ycyA9IHsgZmllbGQ6IFsnZXJyb3InXSB9O1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgVmFsaWRhdGlvbkVycm9yKCdWYWxpZGF0aW9uIGZhaWxlZCcsIGVycm9ycyk7XG4gICAgICBjb25zdCBqc29uID0gZXJyb3IudG9KU09OKCk7XG5cbiAgICAgIGV4cGVjdChqc29uLmVycm9ycykudG9FcXVhbChlcnJvcnMpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmF0ZUxpbWl0RXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDQyOScsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFJhdGVMaW1pdEVycm9yKCdUb28gbWFueSByZXF1ZXN0cycpO1xuXG4gICAgICBleHBlY3QoZXJyb3Iuc3RhdHVzQ29kZSkudG9CZSg0MjkpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW50ZXJuYWxTZXJ2ZXJFcnJvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgc3RhdHVzIGNvZGUgNTAwJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvcignU2VydmVyIGVycm9yJyk7XG5cbiAgICAgIGV4cGVjdChlcnJvci5zdGF0dXNDb2RlKS50b0JlKDUwMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBiZSBvcGVyYXRpb25hbCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IEludGVybmFsU2VydmVyRXJyb3IoKTtcblxuICAgICAgZXhwZWN0KGVycm9yLmlzT3BlcmF0aW9uYWwpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VydmljZVVuYXZhaWxhYmxlRXJyb3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHN0YXR1cyBjb2RlIDUwMycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gbmV3IFNlcnZpY2VVbmF2YWlsYWJsZUVycm9yKCdTZXJ2aWNlIGRvd24nKTtcblxuICAgICAgZXhwZWN0KGVycm9yLnN0YXR1c0NvZGUpLnRvQmUoNTAzKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==