508a6e9da38ac1043b2e0b3f4e3ae182
"use strict";
/**
 * Performance Tests: Load Testing
 *
 * Testing system performance under various load conditions
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const supertest_1 = __importDefault(require("supertest"));
const app_1 = require("../../src/app");
const jwt_utils_1 = require("../../src/libs/auth/jwt.utils");
describe('Load Testing Performance Tests', () => {
    let app;
    let authToken;
    beforeAll(async () => {
        app = await (0, app_1.createApp)();
        authToken = (0, jwt_utils_1.generateToken)({
            userId: 'perf-user-123',
            email: 'perf@test.com',
            role: 'customer',
        });
    });
    describe('Concurrent User Load', () => {
        it('should handle 100 concurrent GET requests for product list', async () => {
            const startTime = Date.now();
            const concurrentRequests = 100;
            const requests = Array.from({ length: concurrentRequests }, () => (0, supertest_1.default)(app).get('/api/products?page=1&limit=10'));
            const responses = await Promise.all(requests);
            const endTime = Date.now();
            const duration = endTime - startTime;
            // All requests should succeed
            expect(responses.every(r => r.status === 200)).toBe(true);
            // Should complete within reasonable time (10 seconds for 100 requests)
            expect(duration).toBeLessThan(10000);
            // Calculate average response time
            const avgResponseTime = duration / concurrentRequests;
            expect(avgResponseTime).toBeLessThan(100); // < 100ms per request
            console.log(`100 concurrent requests completed in ${duration}ms`);
            console.log(`Average response time: ${avgResponseTime.toFixed(2)}ms`);
        });
        it('should handle 50 concurrent authenticated requests', async () => {
            const startTime = Date.now();
            const requests = Array.from({ length: 50 }, () => (0, supertest_1.default)(app)
                .get('/api/users/profile')
                .set('Authorization', `Bearer ${authToken}`));
            const responses = await Promise.all(requests);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(responses.every(r => r.status === 200)).toBe(true);
            expect(duration).toBeLessThan(5000);
            console.log(`50 concurrent auth requests completed in ${duration}ms`);
        });
        it('should handle 200 concurrent product detail requests', async () => {
            const startTime = Date.now();
            const productIds = Array.from({ length: 10 }, (_, i) => `prod-${i + 1}`);
            // Request each product 20 times concurrently
            const requests = productIds.flatMap(id => Array.from({ length: 20 }, () => (0, supertest_1.default)(app).get(`/api/products/${id}`)));
            const responses = await Promise.all(requests);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(responses.filter(r => r.status === 200).length).toBeGreaterThan(0);
            expect(duration).toBeLessThan(15000);
            console.log(`200 concurrent product requests completed in ${duration}ms`);
        });
    });
    describe('Search Performance', () => {
        it('should handle search queries efficiently', async () => {
            const searchTerms = [
                'laptop',
                'mouse',
                'keyboard',
                'monitor',
                'headphones',
            ];
            const startTime = Date.now();
            const requests = searchTerms.map(term => (0, supertest_1.default)(app).get(`/api/products/search?q=${term}`));
            await Promise.all(requests);
            const endTime = Date.now();
            const duration = endTime - startTime;
            // 5 search queries should complete quickly
            expect(duration).toBeLessThan(2000);
            console.log(`5 search queries completed in ${duration}ms`);
        });
        it('should optimize complex filtered queries', async () => {
            const startTime = Date.now();
            await (0, supertest_1.default)(app)
                .get('/api/products?category=electronics&minPrice=50&maxPrice=500&sortBy=price&order=asc')
                .expect(200);
            const endTime = Date.now();
            const duration = endTime - startTime;
            // Complex filtered query should complete quickly
            expect(duration).toBeLessThan(500);
            console.log(`Complex filtered query completed in ${duration}ms`);
        });
    });
    describe('Cart Operations Performance', () => {
        it('should handle rapid cart updates', async () => {
            const startTime = Date.now();
            // Add 10 items to cart sequentially
            for (let i = 1; i <= 10; i++) {
                await (0, supertest_1.default)(app)
                    .post('/api/cart/items')
                    .set('Authorization', `Bearer ${authToken}`)
                    .send({
                    productId: `prod-cart-${i}`,
                    quantity: i,
                })
                    .expect(200);
            }
            const endTime = Date.now();
            const duration = endTime - startTime;
            // 10 cart operations should be fast
            expect(duration).toBeLessThan(3000);
            console.log(`10 sequential cart updates completed in ${duration}ms`);
        });
        it('should retrieve cart quickly', async () => {
            const iterations = 20;
            const startTime = Date.now();
            const requests = Array.from({ length: iterations }, () => (0, supertest_1.default)(app)
                .get('/api/cart')
                .set('Authorization', `Bearer ${authToken}`));
            await Promise.all(requests);
            const endTime = Date.now();
            const duration = endTime - startTime;
            const avgTime = duration / iterations;
            expect(avgTime).toBeLessThan(50); // < 50ms average
            console.log(`${iterations} cart retrievals completed in ${duration}ms (avg: ${avgTime.toFixed(2)}ms)`);
        });
    });
    describe('Order Processing Performance', () => {
        it('should create orders efficiently under load', async () => {
            const orderCount = 20;
            const startTime = Date.now();
            const tokens = Array.from({ length: orderCount }, (_, i) => (0, jwt_utils_1.generateToken)({
                userId: `user-order-${i}`,
                email: `order${i}@test.com`,
                role: 'customer',
            }));
            const requests = tokens.map(token => (0, supertest_1.default)(app)
                .post('/api/orders')
                .set('Authorization', `Bearer ${token}`)
                .send({
                shippingAddress: {
                    street: '123 Perf St',
                    zip: '12345',
                    country: 'US',
                },
            }));
            const responses = await Promise.all(requests);
            const endTime = Date.now();
            const duration = endTime - startTime;
            const successCount = responses.filter(r => r.status === 201).length;
            expect(successCount).toBeGreaterThan(0);
            console.log(`${orderCount} orders created in ${duration}ms`);
        });
        it('should retrieve order history efficiently', async () => {
            const startTime = Date.now();
            await (0, supertest_1.default)(app)
                .get('/api/orders?page=1&limit=50')
                .set('Authorization', `Bearer ${authToken}`)
                .expect(200);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(duration).toBeLessThan(1000);
            console.log(`Order history retrieval completed in ${duration}ms`);
        });
    });
    describe('Database Query Optimization', () => {
        it('should optimize paginated queries', async () => {
            const pages = [1, 2, 3, 4, 5];
            const startTime = Date.now();
            const requests = pages.map(page => (0, supertest_1.default)(app).get(`/api/products?page=${page}&limit=20`));
            await Promise.all(requests);
            const endTime = Date.now();
            const duration = endTime - startTime;
            // 5 paginated queries should be fast
            expect(duration).toBeLessThan(2500);
            console.log(`5 paginated queries completed in ${duration}ms`);
        });
        it('should optimize joins for product with reviews', async () => {
            const startTime = Date.now();
            await (0, supertest_1.default)(app).get('/api/products/prod-with-reviews').expect(200);
            await (0, supertest_1.default)(app)
                .get('/api/products/prod-with-reviews/reviews')
                .expect(200);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(duration).toBeLessThan(500);
            console.log(`Product with reviews query completed in ${duration}ms`);
        });
        it('should use indexes for filtered searches', async () => {
            const startTime = Date.now();
            await (0, supertest_1.default)(app)
                .get('/api/products?category=electronics&inStock=true&minPrice=100')
                .expect(200);
            const endTime = Date.now();
            const duration = endTime - startTime;
            // Indexed query should be very fast
            expect(duration).toBeLessThan(300);
            console.log(`Indexed filtered search completed in ${duration}ms`);
        });
    });
    describe('API Response Time SLA', () => {
        it('should meet 95th percentile response time < 200ms for product list', async () => {
            const iterations = 100;
            const responseTimes = [];
            for (let i = 0; i < iterations; i++) {
                const startTime = Date.now();
                await (0, supertest_1.default)(app).get('/api/products?page=1&limit=10');
                const endTime = Date.now();
                responseTimes.push(endTime - startTime);
            }
            // Sort to calculate percentiles
            responseTimes.sort((a, b) => a - b);
            const p95Index = Math.floor(iterations * 0.95);
            const p95Time = responseTimes[p95Index];
            const avgTime = responseTimes.reduce((a, b) => a + b, 0) / iterations;
            expect(p95Time).toBeLessThan(200);
            console.log(`Product list - Avg: ${avgTime.toFixed(2)}ms, P95: ${p95Time}ms`);
        });
        it('should meet 99th percentile response time < 500ms for search', async () => {
            const iterations = 100;
            const responseTimes = [];
            for (let i = 0; i < iterations; i++) {
                const startTime = Date.now();
                await (0, supertest_1.default)(app).get('/api/products/search?q=test');
                const endTime = Date.now();
                responseTimes.push(endTime - startTime);
            }
            responseTimes.sort((a, b) => a - b);
            const p99Index = Math.floor(iterations * 0.99);
            const p99Time = responseTimes[p99Index];
            expect(p99Time).toBeLessThan(500);
            console.log(`Search - P99: ${p99Time}ms`);
        });
    });
    describe('Memory and Resource Usage', () => {
        it('should not leak memory during repeated requests', async () => {
            const initialMemory = process.memoryUsage().heapUsed;
            // Make 1000 requests
            for (let i = 0; i < 1000; i++) {
                await (0, supertest_1.default)(app).get('/api/products?page=1&limit=10');
                // Trigger GC every 100 requests if available
                if (i % 100 === 0 && global.gc) {
                    global.gc();
                }
            }
            const finalMemory = process.memoryUsage().heapUsed;
            const memoryIncrease = finalMemory - initialMemory;
            const memoryIncreaseMB = memoryIncrease / 1024 / 1024;
            // Memory increase should be reasonable (< 50MB)
            expect(memoryIncreaseMB).toBeLessThan(50);
            console.log(`Memory increase after 1000 requests: ${memoryIncreaseMB.toFixed(2)}MB`);
        });
    });
    describe('Stress Testing', () => {
        it('should handle burst traffic', async () => {
            const burstSize = 50;
            const startTime = Date.now();
            // Simulate sudden burst of traffic
            const burst1 = Array.from({ length: burstSize }, () => (0, supertest_1.default)(app).get('/api/products'));
            await new Promise(resolve => setTimeout(resolve, 100));
            const burst2 = Array.from({ length: burstSize }, () => (0, supertest_1.default)(app).get('/api/products/search?q=laptop'));
            await new Promise(resolve => setTimeout(resolve, 100));
            const burst3 = Array.from({ length: burstSize }, () => (0, supertest_1.default)(app).get('/api/products/top-selling'));
            await Promise.all([...burst1, ...burst2, ...burst3]);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(duration).toBeLessThan(10000);
            console.log(`Handled 150 requests in bursts: ${duration}ms`);
        });
        it('should maintain performance under sustained load', async () => {
            const duration = 5000; // 5 seconds
            const startTime = Date.now();
            let requestCount = 0;
            // Keep sending requests for 5 seconds
            while (Date.now() - startTime < duration) {
                await (0, supertest_1.default)(app).get('/api/products?page=1&limit=10');
                requestCount++;
            }
            const actualDuration = Date.now() - startTime;
            const requestsPerSecond = (requestCount / actualDuration) * 1000;
            // Should handle at least 20 requests per second
            expect(requestsPerSecond).toBeGreaterThan(20);
            console.log(`Sustained load: ${requestCount} requests in ${actualDuration}ms (${requestsPerSecond.toFixed(2)} req/s)`);
        });
    });
    describe('GraphQL Performance', () => {
        it('should handle complex nested queries efficiently', async () => {
            const query = `
        query {
          products(limit: 10) {
            items {
              id
              name
              reviews(limit: 5) {
                id
                rating
                user {
                  id
                  firstName
                }
              }
            }
          }
        }
      `;
            const startTime = Date.now();
            await (0, supertest_1.default)(app).post('/graphql').send({ query }).expect(200);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(duration).toBeLessThan(1000);
            console.log(`Complex nested GraphQL query completed in ${duration}ms`);
        });
        it('should batch multiple queries efficiently', async () => {
            const query = `
        query {
          products1: products(page: 1, limit: 5) { items { id name } }
          products2: products(page: 2, limit: 5) { items { id name } }
          topSelling: topSellingProducts(limit: 5) { id name }
          topRated: topRatedProducts(limit: 5) { id name }
        }
      `;
            const startTime = Date.now();
            await (0, supertest_1.default)(app).post('/graphql').send({ query }).expect(200);
            const endTime = Date.now();
            const duration = endTime - startTime;
            expect(duration).toBeLessThan(800);
            console.log(`Batched GraphQL queries completed in ${duration}ms`);
        });
    });
    describe('Cache Effectiveness', () => {
        it('should benefit from caching for repeated requests', async () => {
            const productId = 'prod-cache-test';
            // First request (cache miss)
            const startTime1 = Date.now();
            await (0, supertest_1.default)(app).get(`/api/products/${productId}`);
            const duration1 = Date.now() - startTime1;
            // Second request (cache hit)
            const startTime2 = Date.now();
            await (0, supertest_1.default)(app).get(`/api/products/${productId}`);
            const duration2 = Date.now() - startTime2;
            // Cached request should be significantly faster
            expect(duration2).toBeLessThan(duration1 * 0.8);
            console.log(`Cache miss: ${duration1}ms, Cache hit: ${duration2}ms`);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXEFkYXB0aXZlX1Rlc3RpbmdcXHRlc3RzXFxwZXJmb3JtYW5jZVxcbG9hZC10ZXN0aW5nLnBlcmYudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7R0FJRzs7Ozs7QUFFSCwwREFBZ0M7QUFFaEMsdUNBQTBDO0FBQzFDLDZEQUE4RDtBQUU5RCxRQUFRLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO0lBQzlDLElBQUksR0FBWSxDQUFDO0lBQ2pCLElBQUksU0FBaUIsQ0FBQztJQUV0QixTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkIsR0FBRyxHQUFHLE1BQU0sSUFBQSxlQUFTLEdBQUUsQ0FBQztRQUN4QixTQUFTLEdBQUcsSUFBQSx5QkFBYSxFQUFDO1lBQ3hCLE1BQU0sRUFBRSxlQUFlO1lBQ3ZCLEtBQUssRUFBRSxlQUFlO1lBQ3RCLElBQUksRUFBRSxVQUFVO1NBQ2pCLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtRQUNwQyxFQUFFLENBQUMsNERBQTRELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDMUUsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQzdCLE1BQU0sa0JBQWtCLEdBQUcsR0FBRyxDQUFDO1lBRS9CLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsa0JBQWtCLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FDL0QsSUFBQSxtQkFBTyxFQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQyxDQUNsRCxDQUFDO1lBRUYsTUFBTSxTQUFTLEdBQUcsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRTlDLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUMzQixNQUFNLFFBQVEsR0FBRyxPQUFPLEdBQUcsU0FBUyxDQUFDO1lBRXJDLDhCQUE4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IjpbIkM6XFxBZGFwdGl2ZV9UZXN0aW5nXFx0ZXN0c1xccGVyZm9ybWFuY2VcXGxvYWQtdGVzdGluZy5wZXJmLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQZXJmb3JtYW5jZSBUZXN0czogTG9hZCBUZXN0aW5nXG4gKlxuICogVGVzdGluZyBzeXN0ZW0gcGVyZm9ybWFuY2UgdW5kZXIgdmFyaW91cyBsb2FkIGNvbmRpdGlvbnNcbiAqL1xuXG5pbXBvcnQgcmVxdWVzdCBmcm9tICdzdXBlcnRlc3QnO1xuaW1wb3J0IHsgRXhwcmVzcyB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgY3JlYXRlQXBwIH0gZnJvbSAnLi4vLi4vc3JjL2FwcCc7XG5pbXBvcnQgeyBnZW5lcmF0ZVRva2VuIH0gZnJvbSAnLi4vLi4vc3JjL2xpYnMvYXV0aC9qd3QudXRpbHMnO1xuXG5kZXNjcmliZSgnTG9hZCBUZXN0aW5nIFBlcmZvcm1hbmNlIFRlc3RzJywgKCkgPT4ge1xuICBsZXQgYXBwOiBFeHByZXNzO1xuICBsZXQgYXV0aFRva2VuOiBzdHJpbmc7XG5cbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICBhcHAgPSBhd2FpdCBjcmVhdGVBcHAoKTtcbiAgICBhdXRoVG9rZW4gPSBnZW5lcmF0ZVRva2VuKHtcbiAgICAgIHVzZXJJZDogJ3BlcmYtdXNlci0xMjMnLFxuICAgICAgZW1haWw6ICdwZXJmQHRlc3QuY29tJyxcbiAgICAgIHJvbGU6ICdjdXN0b21lcicsXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb25jdXJyZW50IFVzZXIgTG9hZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSAxMDAgY29uY3VycmVudCBHRVQgcmVxdWVzdHMgZm9yIHByb2R1Y3QgbGlzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBjb25jdXJyZW50UmVxdWVzdHMgPSAxMDA7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3RzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29uY3VycmVudFJlcXVlc3RzIH0sICgpID0+XG4gICAgICAgIHJlcXVlc3QoYXBwKS5nZXQoJy9hcGkvcHJvZHVjdHM/cGFnZT0xJmxpbWl0PTEwJylcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIEFsbCByZXF1ZXN0cyBzaG91bGQgc3VjY2VlZFxuICAgICAgZXhwZWN0KHJlc3BvbnNlcy5ldmVyeShyID0+IHIuc3RhdHVzID09PSAyMDApKS50b0JlKHRydWUpO1xuXG4gICAgICAvLyBTaG91bGQgY29tcGxldGUgd2l0aGluIHJlYXNvbmFibGUgdGltZSAoMTAgc2Vjb25kcyBmb3IgMTAwIHJlcXVlc3RzKVxuICAgICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMTAwMDApO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgYXZlcmFnZSByZXNwb25zZSB0aW1lXG4gICAgICBjb25zdCBhdmdSZXNwb25zZVRpbWUgPSBkdXJhdGlvbiAvIGNvbmN1cnJlbnRSZXF1ZXN0cztcbiAgICAgIGV4cGVjdChhdmdSZXNwb25zZVRpbWUpLnRvQmVMZXNzVGhhbigxMDApOyAvLyA8IDEwMG1zIHBlciByZXF1ZXN0XG5cbiAgICAgIGNvbnNvbGUubG9nKGAxMDAgY29uY3VycmVudCByZXF1ZXN0cyBjb21wbGV0ZWQgaW4gJHtkdXJhdGlvbn1tc2ApO1xuICAgICAgY29uc29sZS5sb2coYEF2ZXJhZ2UgcmVzcG9uc2UgdGltZTogJHthdmdSZXNwb25zZVRpbWUudG9GaXhlZCgyKX1tc2ApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgNTAgY29uY3VycmVudCBhdXRoZW50aWNhdGVkIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgY29uc3QgcmVxdWVzdHMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiA1MCB9LCAoKSA9PlxuICAgICAgICByZXF1ZXN0KGFwcClcbiAgICAgICAgICAuZ2V0KCcvYXBpL3VzZXJzL3Byb2ZpbGUnKVxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YXV0aFRva2VufWApXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXF1ZXN0cyk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2VzLmV2ZXJ5KHIgPT4gci5zdGF0dXMgPT09IDIwMCkpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbig1MDAwKTtcblxuICAgICAgY29uc29sZS5sb2coYDUwIGNvbmN1cnJlbnQgYXV0aCByZXF1ZXN0cyBjb21wbGV0ZWQgaW4gJHtkdXJhdGlvbn1tc2ApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgMjAwIGNvbmN1cnJlbnQgcHJvZHVjdCBkZXRhaWwgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcHJvZHVjdElkcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwIH0sIChfLCBpKSA9PiBgcHJvZC0ke2kgKyAxfWApO1xuXG4gICAgICAvLyBSZXF1ZXN0IGVhY2ggcHJvZHVjdCAyMCB0aW1lcyBjb25jdXJyZW50bHlcbiAgICAgIGNvbnN0IHJlcXVlc3RzID0gcHJvZHVjdElkcy5mbGF0TWFwKGlkID0+XG4gICAgICAgIEFycmF5LmZyb20oeyBsZW5ndGg6IDIwIH0sICgpID0+IHJlcXVlc3QoYXBwKS5nZXQoYC9hcGkvcHJvZHVjdHMvJHtpZH1gKSlcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZXMuZmlsdGVyKHIgPT4gci5zdGF0dXMgPT09IDIwMCkubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigxNTAwMCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGAyMDAgY29uY3VycmVudCBwcm9kdWN0IHJlcXVlc3RzIGNvbXBsZXRlZCBpbiAke2R1cmF0aW9ufW1zYCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWFyY2ggUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VhcmNoIHF1ZXJpZXMgZWZmaWNpZW50bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzZWFyY2hUZXJtcyA9IFtcbiAgICAgICAgJ2xhcHRvcCcsXG4gICAgICAgICdtb3VzZScsXG4gICAgICAgICdrZXlib2FyZCcsXG4gICAgICAgICdtb25pdG9yJyxcbiAgICAgICAgJ2hlYWRwaG9uZXMnLFxuICAgICAgXTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgY29uc3QgcmVxdWVzdHMgPSBzZWFyY2hUZXJtcy5tYXAodGVybSA9PlxuICAgICAgICByZXF1ZXN0KGFwcCkuZ2V0KGAvYXBpL3Byb2R1Y3RzL3NlYXJjaD9xPSR7dGVybX1gKVxuICAgICAgKTtcblxuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocmVxdWVzdHMpO1xuXG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gZW5kVGltZSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gNSBzZWFyY2ggcXVlcmllcyBzaG91bGQgY29tcGxldGUgcXVpY2tseVxuICAgICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMjAwMCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGA1IHNlYXJjaCBxdWVyaWVzIGNvbXBsZXRlZCBpbiAke2R1cmF0aW9ufW1zYCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG9wdGltaXplIGNvbXBsZXggZmlsdGVyZWQgcXVlcmllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KFxuICAgICAgICAgICcvYXBpL3Byb2R1Y3RzP2NhdGVnb3J5PWVsZWN0cm9uaWNzJm1pblByaWNlPTUwJm1heFByaWNlPTUwMCZzb3J0Qnk9cHJpY2Umb3JkZXI9YXNjJ1xuICAgICAgICApXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIENvbXBsZXggZmlsdGVyZWQgcXVlcnkgc2hvdWxkIGNvbXBsZXRlIHF1aWNrbHlcbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDUwMCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGBDb21wbGV4IGZpbHRlcmVkIHF1ZXJ5IGNvbXBsZXRlZCBpbiAke2R1cmF0aW9ufW1zYCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDYXJ0IE9wZXJhdGlvbnMgUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcmFwaWQgY2FydCB1cGRhdGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgLy8gQWRkIDEwIGl0ZW1zIHRvIGNhcnQgc2VxdWVudGlhbGx5XG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSAxMDsgaSsrKSB7XG4gICAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5wb3N0KCcvYXBpL2NhcnQvaXRlbXMnKVxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YXV0aFRva2VufWApXG4gICAgICAgICAgLnNlbmQoe1xuICAgICAgICAgICAgcHJvZHVjdElkOiBgcHJvZC1jYXJ0LSR7aX1gLFxuICAgICAgICAgICAgcXVhbnRpdHk6IGksXG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZXhwZWN0KDIwMCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuXG4gICAgICAvLyAxMCBjYXJ0IG9wZXJhdGlvbnMgc2hvdWxkIGJlIGZhc3RcbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDMwMDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhgMTAgc2VxdWVudGlhbCBjYXJ0IHVwZGF0ZXMgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0cmlldmUgY2FydCBxdWlja2x5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaXRlcmF0aW9ucyA9IDIwO1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgY29uc3QgcmVxdWVzdHMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBpdGVyYXRpb25zIH0sICgpID0+XG4gICAgICAgIHJlcXVlc3QoYXBwKVxuICAgICAgICAgIC5nZXQoJy9hcGkvY2FydCcpXG4gICAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHthdXRoVG9rZW59YClcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKHJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG4gICAgICBjb25zdCBhdmdUaW1lID0gZHVyYXRpb24gLyBpdGVyYXRpb25zO1xuXG4gICAgICBleHBlY3QoYXZnVGltZSkudG9CZUxlc3NUaGFuKDUwKTsgLy8gPCA1MG1zIGF2ZXJhZ2VcblxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGAke2l0ZXJhdGlvbnN9IGNhcnQgcmV0cmlldmFscyBjb21wbGV0ZWQgaW4gJHtkdXJhdGlvbn1tcyAoYXZnOiAke2F2Z1RpbWUudG9GaXhlZCgyKX1tcylgXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnT3JkZXIgUHJvY2Vzc2luZyBQZXJmb3JtYW5jZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBvcmRlcnMgZWZmaWNpZW50bHkgdW5kZXIgbG9hZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9yZGVyQ291bnQgPSAyMDtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cbiAgICAgIGNvbnN0IHRva2VucyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IG9yZGVyQ291bnQgfSwgKF8sIGkpID0+XG4gICAgICAgIGdlbmVyYXRlVG9rZW4oe1xuICAgICAgICAgIHVzZXJJZDogYHVzZXItb3JkZXItJHtpfWAsXG4gICAgICAgICAgZW1haWw6IGBvcmRlciR7aX1AdGVzdC5jb21gLFxuICAgICAgICAgIHJvbGU6ICdjdXN0b21lcicsXG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXF1ZXN0cyA9IHRva2Vucy5tYXAodG9rZW4gPT5cbiAgICAgICAgcmVxdWVzdChhcHApXG4gICAgICAgICAgLnBvc3QoJy9hcGkvb3JkZXJzJylcbiAgICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke3Rva2VufWApXG4gICAgICAgICAgLnNlbmQoe1xuICAgICAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgICAgIHN0cmVldDogJzEyMyBQZXJmIFN0JyxcbiAgICAgICAgICAgICAgemlwOiAnMTIzNDUnLFxuICAgICAgICAgICAgICBjb3VudHJ5OiAnVVMnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KVxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgUHJvbWlzZS5hbGwocmVxdWVzdHMpO1xuXG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gZW5kVGltZSAtIHN0YXJ0VGltZTtcblxuICAgICAgY29uc3Qgc3VjY2Vzc0NvdW50ID0gcmVzcG9uc2VzLmZpbHRlcihyID0+IHIuc3RhdHVzID09PSAyMDEpLmxlbmd0aDtcbiAgICAgIGV4cGVjdChzdWNjZXNzQ291bnQpLnRvQmVHcmVhdGVyVGhhbigwKTtcblxuICAgICAgY29uc29sZS5sb2coYCR7b3JkZXJDb3VudH0gb3JkZXJzIGNyZWF0ZWQgaW4gJHtkdXJhdGlvbn1tc2ApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXRyaWV2ZSBvcmRlciBoaXN0b3J5IGVmZmljaWVudGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvb3JkZXJzP3BhZ2U9MSZsaW1pdD01MCcpXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YXV0aFRva2VufWApXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDEwMDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhgT3JkZXIgaGlzdG9yeSByZXRyaWV2YWwgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGFiYXNlIFF1ZXJ5IE9wdGltaXphdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG9wdGltaXplIHBhZ2luYXRlZCBxdWVyaWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFnZXMgPSBbMSwgMiwgMywgNCwgNV07XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICBjb25zdCByZXF1ZXN0cyA9IHBhZ2VzLm1hcChwYWdlID0+XG4gICAgICAgIHJlcXVlc3QoYXBwKS5nZXQoYC9hcGkvcHJvZHVjdHM/cGFnZT0ke3BhZ2V9JmxpbWl0PTIwYClcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKHJlcXVlc3RzKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIDUgcGFnaW5hdGVkIHF1ZXJpZXMgc2hvdWxkIGJlIGZhc3RcbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDI1MDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhgNSBwYWdpbmF0ZWQgcXVlcmllcyBjb21wbGV0ZWQgaW4gJHtkdXJhdGlvbn1tc2ApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBvcHRpbWl6ZSBqb2lucyBmb3IgcHJvZHVjdCB3aXRoIHJldmlld3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcCkuZ2V0KCcvYXBpL3Byb2R1Y3RzL3Byb2Qtd2l0aC1yZXZpZXdzJykuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKVxuICAgICAgICAuZ2V0KCcvYXBpL3Byb2R1Y3RzL3Byb2Qtd2l0aC1yZXZpZXdzL3Jldmlld3MnKVxuICAgICAgICAuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuXG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbig1MDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhgUHJvZHVjdCB3aXRoIHJldmlld3MgcXVlcnkgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIGluZGV4ZXMgZm9yIGZpbHRlcmVkIHNlYXJjaGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgYXdhaXQgcmVxdWVzdChhcHApXG4gICAgICAgIC5nZXQoJy9hcGkvcHJvZHVjdHM/Y2F0ZWdvcnk9ZWxlY3Ryb25pY3MmaW5TdG9jaz10cnVlJm1pblByaWNlPTEwMCcpXG4gICAgICAgIC5leHBlY3QoMjAwKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIEluZGV4ZWQgcXVlcnkgc2hvdWxkIGJlIHZlcnkgZmFzdFxuICAgICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMzAwKTtcblxuICAgICAgY29uc29sZS5sb2coYEluZGV4ZWQgZmlsdGVyZWQgc2VhcmNoIGNvbXBsZXRlZCBpbiAke2R1cmF0aW9ufW1zYCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBUEkgUmVzcG9uc2UgVGltZSBTTEEnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBtZWV0IDk1dGggcGVyY2VudGlsZSByZXNwb25zZSB0aW1lIDwgMjAwbXMgZm9yIHByb2R1Y3QgbGlzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGl0ZXJhdGlvbnMgPSAxMDA7XG4gICAgICBjb25zdCByZXNwb25zZVRpbWVzOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBhd2FpdCByZXF1ZXN0KGFwcCkuZ2V0KCcvYXBpL3Byb2R1Y3RzP3BhZ2U9MSZsaW1pdD0xMCcpO1xuICAgICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgcmVzcG9uc2VUaW1lcy5wdXNoKGVuZFRpbWUgLSBzdGFydFRpbWUpO1xuICAgICAgfVxuXG4gICAgICAvLyBTb3J0IHRvIGNhbGN1bGF0ZSBwZXJjZW50aWxlc1xuICAgICAgcmVzcG9uc2VUaW1lcy5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG4gICAgICBjb25zdCBwOTVJbmRleCA9IE1hdGguZmxvb3IoaXRlcmF0aW9ucyAqIDAuOTUpO1xuICAgICAgY29uc3QgcDk1VGltZSA9IHJlc3BvbnNlVGltZXNbcDk1SW5kZXhdO1xuICAgICAgY29uc3QgYXZnVGltZSA9IHJlc3BvbnNlVGltZXMucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyBpdGVyYXRpb25zO1xuXG4gICAgICBleHBlY3QocDk1VGltZSkudG9CZUxlc3NUaGFuKDIwMCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGBQcm9kdWN0IGxpc3QgLSBBdmc6ICR7YXZnVGltZS50b0ZpeGVkKDIpfW1zLCBQOTU6ICR7cDk1VGltZX1tc2ApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBtZWV0IDk5dGggcGVyY2VudGlsZSByZXNwb25zZSB0aW1lIDwgNTAwbXMgZm9yIHNlYXJjaCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGl0ZXJhdGlvbnMgPSAxMDA7XG4gICAgICBjb25zdCByZXNwb25zZVRpbWVzOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBhd2FpdCByZXF1ZXN0KGFwcCkuZ2V0KCcvYXBpL3Byb2R1Y3RzL3NlYXJjaD9xPXRlc3QnKTtcbiAgICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIHJlc3BvbnNlVGltZXMucHVzaChlbmRUaW1lIC0gc3RhcnRUaW1lKTtcbiAgICAgIH1cblxuICAgICAgcmVzcG9uc2VUaW1lcy5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG4gICAgICBjb25zdCBwOTlJbmRleCA9IE1hdGguZmxvb3IoaXRlcmF0aW9ucyAqIDAuOTkpO1xuICAgICAgY29uc3QgcDk5VGltZSA9IHJlc3BvbnNlVGltZXNbcDk5SW5kZXhdO1xuXG4gICAgICBleHBlY3QocDk5VGltZSkudG9CZUxlc3NUaGFuKDUwMCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGBTZWFyY2ggLSBQOTk6ICR7cDk5VGltZX1tc2ApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTWVtb3J5IGFuZCBSZXNvdXJjZSBVc2FnZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG5vdCBsZWFrIG1lbW9yeSBkdXJpbmcgcmVwZWF0ZWQgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbml0aWFsTWVtb3J5ID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLmhlYXBVc2VkO1xuXG4gICAgICAvLyBNYWtlIDEwMDAgcmVxdWVzdHNcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwMDsgaSsrKSB7XG4gICAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKS5nZXQoJy9hcGkvcHJvZHVjdHM/cGFnZT0xJmxpbWl0PTEwJyk7XG5cbiAgICAgICAgLy8gVHJpZ2dlciBHQyBldmVyeSAxMDAgcmVxdWVzdHMgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChpICUgMTAwID09PSAwICYmIGdsb2JhbC5nYykge1xuICAgICAgICAgIGdsb2JhbC5nYygpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpbmFsTWVtb3J5ID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLmhlYXBVc2VkO1xuICAgICAgY29uc3QgbWVtb3J5SW5jcmVhc2UgPSBmaW5hbE1lbW9yeSAtIGluaXRpYWxNZW1vcnk7XG4gICAgICBjb25zdCBtZW1vcnlJbmNyZWFzZU1CID0gbWVtb3J5SW5jcmVhc2UgLyAxMDI0IC8gMTAyNDtcblxuICAgICAgLy8gTWVtb3J5IGluY3JlYXNlIHNob3VsZCBiZSByZWFzb25hYmxlICg8IDUwTUIpXG4gICAgICBleHBlY3QobWVtb3J5SW5jcmVhc2VNQikudG9CZUxlc3NUaGFuKDUwKTtcblxuICAgICAgY29uc29sZS5sb2coYE1lbW9yeSBpbmNyZWFzZSBhZnRlciAxMDAwIHJlcXVlc3RzOiAke21lbW9yeUluY3JlYXNlTUIudG9GaXhlZCgyKX1NQmApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3RyZXNzIFRlc3RpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYnVyc3QgdHJhZmZpYycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGJ1cnN0U2l6ZSA9IDUwO1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgLy8gU2ltdWxhdGUgc3VkZGVuIGJ1cnN0IG9mIHRyYWZmaWNcbiAgICAgIGNvbnN0IGJ1cnN0MSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGJ1cnN0U2l6ZSB9LCAoKSA9PlxuICAgICAgICByZXF1ZXN0KGFwcCkuZ2V0KCcvYXBpL3Byb2R1Y3RzJylcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcblxuICAgICAgY29uc3QgYnVyc3QyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogYnVyc3RTaXplIH0sICgpID0+XG4gICAgICAgIHJlcXVlc3QoYXBwKS5nZXQoJy9hcGkvcHJvZHVjdHMvc2VhcmNoP3E9bGFwdG9wJylcbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDApKTtcblxuICAgICAgY29uc3QgYnVyc3QzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogYnVyc3RTaXplIH0sICgpID0+XG4gICAgICAgIHJlcXVlc3QoYXBwKS5nZXQoJy9hcGkvcHJvZHVjdHMvdG9wLXNlbGxpbmcnKVxuICAgICAgKTtcblxuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoWy4uLmJ1cnN0MSwgLi4uYnVyc3QyLCAuLi5idXJzdDNdKTtcblxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIGV4cGVjdChkdXJhdGlvbikudG9CZUxlc3NUaGFuKDEwMDAwKTtcblxuICAgICAgY29uc29sZS5sb2coYEhhbmRsZWQgMTUwIHJlcXVlc3RzIGluIGJ1cnN0czogJHtkdXJhdGlvbn1tc2ApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBtYWludGFpbiBwZXJmb3JtYW5jZSB1bmRlciBzdXN0YWluZWQgbG9hZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gNTAwMDsgLy8gNSBzZWNvbmRzXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgbGV0IHJlcXVlc3RDb3VudCA9IDA7XG5cbiAgICAgIC8vIEtlZXAgc2VuZGluZyByZXF1ZXN0cyBmb3IgNSBzZWNvbmRzXG4gICAgICB3aGlsZSAoRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSA8IGR1cmF0aW9uKSB7XG4gICAgICAgIGF3YWl0IHJlcXVlc3QoYXBwKS5nZXQoJy9hcGkvcHJvZHVjdHM/cGFnZT0xJmxpbWl0PTEwJyk7XG4gICAgICAgIHJlcXVlc3RDb3VudCsrO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhY3R1YWxEdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBjb25zdCByZXF1ZXN0c1BlclNlY29uZCA9IChyZXF1ZXN0Q291bnQgLyBhY3R1YWxEdXJhdGlvbikgKiAxMDAwO1xuXG4gICAgICAvLyBTaG91bGQgaGFuZGxlIGF0IGxlYXN0IDIwIHJlcXVlc3RzIHBlciBzZWNvbmRcbiAgICAgIGV4cGVjdChyZXF1ZXN0c1BlclNlY29uZCkudG9CZUdyZWF0ZXJUaGFuKDIwKTtcblxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGBTdXN0YWluZWQgbG9hZDogJHtyZXF1ZXN0Q291bnR9IHJlcXVlc3RzIGluICR7YWN0dWFsRHVyYXRpb259bXMgKCR7cmVxdWVzdHNQZXJTZWNvbmQudG9GaXhlZCgyKX0gcmVxL3MpYFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dyYXBoUUwgUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tcGxleCBuZXN0ZWQgcXVlcmllcyBlZmZpY2llbnRseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgICBxdWVyeSB7XG4gICAgICAgICAgcHJvZHVjdHMobGltaXQ6IDEwKSB7XG4gICAgICAgICAgICBpdGVtcyB7XG4gICAgICAgICAgICAgIGlkXG4gICAgICAgICAgICAgIG5hbWVcbiAgICAgICAgICAgICAgcmV2aWV3cyhsaW1pdDogNSkge1xuICAgICAgICAgICAgICAgIGlkXG4gICAgICAgICAgICAgICAgcmF0aW5nXG4gICAgICAgICAgICAgICAgdXNlciB7XG4gICAgICAgICAgICAgICAgICBpZFxuICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBgO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcCkucG9zdCgnL2dyYXBocWwnKS5zZW5kKHsgcXVlcnkgfSkuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuXG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigxMDAwKTtcblxuICAgICAgY29uc29sZS5sb2coYENvbXBsZXggbmVzdGVkIEdyYXBoUUwgcXVlcnkgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYmF0Y2ggbXVsdGlwbGUgcXVlcmllcyBlZmZpY2llbnRseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgICBxdWVyeSB7XG4gICAgICAgICAgcHJvZHVjdHMxOiBwcm9kdWN0cyhwYWdlOiAxLCBsaW1pdDogNSkgeyBpdGVtcyB7IGlkIG5hbWUgfSB9XG4gICAgICAgICAgcHJvZHVjdHMyOiBwcm9kdWN0cyhwYWdlOiAyLCBsaW1pdDogNSkgeyBpdGVtcyB7IGlkIG5hbWUgfSB9XG4gICAgICAgICAgdG9wU2VsbGluZzogdG9wU2VsbGluZ1Byb2R1Y3RzKGxpbWl0OiA1KSB7IGlkIG5hbWUgfVxuICAgICAgICAgIHRvcFJhdGVkOiB0b3BSYXRlZFByb2R1Y3RzKGxpbWl0OiA1KSB7IGlkIG5hbWUgfVxuICAgICAgICB9XG4gICAgICBgO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcCkucG9zdCgnL2dyYXBocWwnKS5zZW5kKHsgcXVlcnkgfSkuZXhwZWN0KDIwMCk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuXG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbig4MDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhgQmF0Y2hlZCBHcmFwaFFMIHF1ZXJpZXMgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NhY2hlIEVmZmVjdGl2ZW5lc3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBiZW5lZml0IGZyb20gY2FjaGluZyBmb3IgcmVwZWF0ZWQgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9kdWN0SWQgPSAncHJvZC1jYWNoZS10ZXN0JztcblxuICAgICAgLy8gRmlyc3QgcmVxdWVzdCAoY2FjaGUgbWlzcylcbiAgICAgIGNvbnN0IHN0YXJ0VGltZTEgPSBEYXRlLm5vdygpO1xuICAgICAgYXdhaXQgcmVxdWVzdChhcHApLmdldChgL2FwaS9wcm9kdWN0cy8ke3Byb2R1Y3RJZH1gKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uMSA9IERhdGUubm93KCkgLSBzdGFydFRpbWUxO1xuXG4gICAgICAvLyBTZWNvbmQgcmVxdWVzdCAoY2FjaGUgaGl0KVxuICAgICAgY29uc3Qgc3RhcnRUaW1lMiA9IERhdGUubm93KCk7XG4gICAgICBhd2FpdCByZXF1ZXN0KGFwcCkuZ2V0KGAvYXBpL3Byb2R1Y3RzLyR7cHJvZHVjdElkfWApO1xuICAgICAgY29uc3QgZHVyYXRpb24yID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTI7XG5cbiAgICAgIC8vIENhY2hlZCByZXF1ZXN0IHNob3VsZCBiZSBzaWduaWZpY2FudGx5IGZhc3RlclxuICAgICAgZXhwZWN0KGR1cmF0aW9uMikudG9CZUxlc3NUaGFuKGR1cmF0aW9uMSAqIDAuOCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGBDYWNoZSBtaXNzOiAke2R1cmF0aW9uMX1tcywgQ2FjaGUgaGl0OiAke2R1cmF0aW9uMn1tc2ApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9