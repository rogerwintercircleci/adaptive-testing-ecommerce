e9137decc5ebe77ecbea12ba9d725024
"use strict";
/**
 * TDD: Product Repository Tests
 *
 * Comprehensive tests for product repository operations
 * Following strict TDD: Tests written first, then implementation
 */
Object.defineProperty(exports, "__esModule", { value: true });
const product_repository_1 = require("./product.repository");
const product_entity_1 = require("../entities/product.entity");
const errors_1 = require("@libs/errors");
const mockRepository = {
    find: jest.fn(),
    findOne: jest.fn(),
    findAndCount: jest.fn(),
    create: jest.fn(),
    save: jest.fn(),
    remove: jest.fn(),
    count: jest.fn(),
    merge: jest.fn(),
    createQueryBuilder: jest.fn(),
    metadata: { name: 'Product' },
};
describe('ProductRepository', () => {
    let productRepository;
    beforeEach(() => {
        jest.clearAllMocks();
        productRepository = new product_repository_1.ProductRepository(mockRepository);
    });
    describe('findBySku', () => {
        it('should find product by SKU', async () => {
            const mockProduct = {
                id: '123',
                sku: 'TEST-SKU-001',
                name: 'Test Product',
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            const result = await productRepository.findBySku('TEST-SKU-001');
            expect(result).toEqual(mockProduct);
            expect(mockRepository.findOne).toHaveBeenCalledWith({
                where: { sku: 'TEST-SKU-001' },
            });
        });
        it('should return null if product not found', async () => {
            mockRepository.findOne.mockResolvedValue(null);
            const result = await productRepository.findBySku('NON-EXISTENT');
            expect(result).toBeNull();
        });
        it('should be case-sensitive for SKU', async () => {
            const mockProduct = { sku: 'TEST-SKU-001' };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            await productRepository.findBySku('TEST-SKU-001');
            expect(mockRepository.findOne).toHaveBeenCalledWith({
                where: { sku: 'TEST-SKU-001' },
            });
        });
    });
    describe('skuExists', () => {
        it('should return true if SKU exists', async () => {
            mockRepository.count.mockResolvedValue(1);
            const result = await productRepository.skuExists('EXISTING-SKU');
            expect(result).toBe(true);
        });
        it('should return false if SKU does not exist', async () => {
            mockRepository.count.mockResolvedValue(0);
            const result = await productRepository.skuExists('NEW-SKU');
            expect(result).toBe(false);
        });
    });
    describe('createProduct', () => {
        it('should create a new product', async () => {
            const productData = {
                name: 'New Product',
                sku: 'NEW-SKU-001',
                price: 99.99,
                inventory: 10,
            };
            const mockProduct = { id: '456', ...productData };
            mockRepository.count.mockResolvedValue(0);
            mockRepository.create.mockReturnValue(mockProduct);
            mockRepository.save.mockResolvedValue(mockProduct);
            const result = await productRepository.createProduct(productData);
            expect(result).toEqual(mockProduct);
        });
        it('should throw ConflictError if SKU already exists', async () => {
            const productData = {
                name: 'Product',
                sku: 'EXISTING-SKU',
                price: 99.99,
            };
            mockRepository.count.mockResolvedValue(1);
            await expect(productRepository.createProduct(productData)).rejects.toThrow(errors_1.ConflictError);
            await expect(productRepository.createProduct(productData)).rejects.toThrow('Product with this SKU already exists');
        });
    });
    describe('findByStatus', () => {
        it('should find all products with specified status', async () => {
            const mockProducts = [
                { id: '1', status: product_entity_1.ProductStatus.ACTIVE },
                { id: '2', status: product_entity_1.ProductStatus.ACTIVE },
            ];
            mockRepository.find.mockResolvedValue(mockProducts);
            const result = await productRepository.findByStatus(product_entity_1.ProductStatus.ACTIVE);
            expect(result).toEqual(mockProducts);
        });
        it('should return empty array if no products found', async () => {
            mockRepository.find.mockResolvedValue([]);
            const result = await productRepository.findByStatus(product_entity_1.ProductStatus.DISCONTINUED);
            expect(result).toEqual([]);
        });
    });
    describe('findByCategory', () => {
        it('should find all products in category', async () => {
            const mockProducts = [
                { id: '1', categoryId: 'cat-123' },
                { id: '2', categoryId: 'cat-123' },
            ];
            mockRepository.find.mockResolvedValue(mockProducts);
            const result = await productRepository.findByCategory('cat-123');
            expect(result).toEqual(mockProducts);
        });
        it('should return empty array for category with no products', async () => {
            mockRepository.find.mockResolvedValue([]);
            const result = await productRepository.findByCategory('empty-cat');
            expect(result).toEqual([]);
        });
    });
    describe('updateInventory', () => {
        it('should update product inventory', async () => {
            const productId = '123';
            const newInventory = 50;
            const mockProduct = {
                id: productId,
                inventory: 10,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({
                ...mockProduct,
                inventory: newInventory,
            });
            mockRepository.save.mockResolvedValue({
                ...mockProduct,
                inventory: newInventory,
            });
            const result = await productRepository.updateInventory(productId, newInventory);
            expect(result.inventory).toBe(newInventory);
        });
        it('should throw NotFoundError if product not found', async () => {
            mockRepository.findOne.mockResolvedValue(null);
            await expect(productRepository.updateInventory('nonexistent', 10)).rejects.toThrow(errors_1.NotFoundError);
        });
        it('should allow setting inventory to zero', async () => {
            const mockProduct = { id: '123', inventory: 10 };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({ ...mockProduct, inventory: 0 });
            mockRepository.save.mockResolvedValue({ ...mockProduct, inventory: 0 });
            const result = await productRepository.updateInventory('123', 0);
            expect(result.inventory).toBe(0);
        });
    });
    describe('decrementInventory', () => {
        it('should decrement inventory by quantity', async () => {
            const mockProduct = {
                id: '123',
                inventory: 100,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({
                ...mockProduct,
                inventory: 95,
            });
            mockRepository.save.mockResolvedValue({
                ...mockProduct,
                inventory: 95,
            });
            const result = await productRepository.decrementInventory('123', 5);
            expect(result.inventory).toBe(95);
        });
        it('should not allow negative inventory', async () => {
            const mockProduct = {
                id: '123',
                inventory: 5,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            await expect(productRepository.decrementInventory('123', 10)).rejects.toThrow('Insufficient inventory');
        });
        it('should handle exact inventory match', async () => {
            const mockProduct = {
                id: '123',
                inventory: 10,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({
                ...mockProduct,
                inventory: 0,
            });
            mockRepository.save.mockResolvedValue({
                ...mockProduct,
                inventory: 0,
            });
            const result = await productRepository.decrementInventory('123', 10);
            expect(result.inventory).toBe(0);
        });
    });
    describe('incrementInventory', () => {
        it('should increment inventory by quantity', async () => {
            const mockProduct = {
                id: '123',
                inventory: 50,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({
                ...mockProduct,
                inventory: 75,
            });
            mockRepository.save.mockResolvedValue({
                ...mockProduct,
                inventory: 75,
            });
            const result = await productRepository.incrementInventory('123', 25);
            expect(result.inventory).toBe(75);
        });
        it('should increment from zero inventory', async () => {
            const mockProduct = {
                id: '123',
                inventory: 0,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({
                ...mockProduct,
                inventory: 10,
            });
            mockRepository.save.mockResolvedValue({
                ...mockProduct,
                inventory: 10,
            });
            const result = await productRepository.incrementInventory('123', 10);
            expect(result.inventory).toBe(10);
        });
    });
    describe('findLowStock', () => {
        it('should find products with inventory below threshold', async () => {
            const mockBuilder = {
                where: jest.fn().mockReturnThis(),
                andWhere: jest.fn().mockReturnThis(),
                getMany: jest.fn().mockResolvedValue([
                    { id: '1', inventory: 3 },
                    { id: '2', inventory: 5 },
                ]),
            };
            mockRepository.createQueryBuilder.mockReturnValue(mockBuilder);
            const result = await productRepository.findLowStock(10);
            expect(result).toHaveLength(2);
        });
        it('should only return active products with low stock', async () => {
            const mockBuilder = {
                where: jest.fn().mockReturnThis(),
                andWhere: jest.fn().mockReturnThis(),
                getMany: jest.fn().mockResolvedValue([]),
            };
            mockRepository.createQueryBuilder.mockReturnValue(mockBuilder);
            await productRepository.findLowStock(5);
            expect(mockBuilder.where).toHaveBeenCalledWith('product.status = :status', { status: product_entity_1.ProductStatus.ACTIVE });
        });
    });
    describe('findOnSale', () => {
        it('should find products on sale', async () => {
            const mockBuilder = {
                where: jest.fn().mockReturnThis(),
                andWhere: jest.fn().mockReturnThis(),
                getMany: jest.fn().mockResolvedValue([
                    { id: '1', price: 79.99, compareAtPrice: 99.99 },
                    { id: '2', price: 49.99, compareAtPrice: 79.99 },
                ]),
            };
            mockRepository.createQueryBuilder.mockReturnValue(mockBuilder);
            const result = await productRepository.findOnSale();
            expect(result).toHaveLength(2);
        });
    });
    describe('searchProducts', () => {
        it('should search products by name', async () => {
            const mockBuilder = {
                where: jest.fn().mockReturnThis(),
                andWhere: jest.fn().mockReturnThis(),
                orderBy: jest.fn().mockReturnThis(),
                skip: jest.fn().mockReturnThis(),
                take: jest.fn().mockReturnThis(),
                getManyAndCount: jest.fn().mockResolvedValue([
                    [{ id: '1', name: 'Test Product' }],
                    1,
                ]),
            };
            mockRepository.createQueryBuilder.mockReturnValue(mockBuilder);
            const result = await productRepository.searchProducts('test', {});
            expect(result.items).toHaveLength(1);
            expect(result.total).toBe(1);
        });
        it('should support pagination', async () => {
            const mockBuilder = {
                where: jest.fn().mockReturnThis(),
                andWhere: jest.fn().mockReturnThis(),
                orderBy: jest.fn().mockReturnThis(),
                skip: jest.fn().mockReturnThis(),
                take: jest.fn().mockReturnThis(),
                getManyAndCount: jest.fn().mockResolvedValue([[], 0]),
            };
            mockRepository.createQueryBuilder.mockReturnValue(mockBuilder);
            await productRepository.searchProducts('query', { page: 2, limit: 20 });
            expect(mockBuilder.skip).toHaveBeenCalledWith(20);
            expect(mockBuilder.take).toHaveBeenCalledWith(20);
        });
        it('should filter by price range', async () => {
            const mockBuilder = {
                where: jest.fn().mockReturnThis(),
                andWhere: jest.fn().mockReturnThis(),
                orderBy: jest.fn().mockReturnThis(),
                skip: jest.fn().mockReturnThis(),
                take: jest.fn().mockReturnThis(),
                getManyAndCount: jest.fn().mockResolvedValue([[], 0]),
            };
            mockRepository.createQueryBuilder.mockReturnValue(mockBuilder);
            await productRepository.searchProducts('query', {
                minPrice: 10,
                maxPrice: 100,
            });
            expect(mockBuilder.andWhere).toHaveBeenCalled();
        });
        it('should filter by category', async () => {
            const mockBuilder = {
                where: jest.fn().mockReturnThis(),
                andWhere: jest.fn().mockReturnThis(),
                orderBy: jest.fn().mockReturnThis(),
                skip: jest.fn().mockReturnThis(),
                take: jest.fn().mockReturnThis(),
                getManyAndCount: jest.fn().mockResolvedValue([[], 0]),
            };
            mockRepository.createQueryBuilder.mockReturnValue(mockBuilder);
            await productRepository.searchProducts('query', {
                categoryId: 'cat-123',
            });
            expect(mockBuilder.andWhere).toHaveBeenCalled();
        });
    });
    describe('updateRating', () => {
        it('should update product rating and review count', async () => {
            const mockProduct = {
                id: '123',
                rating: 4.0,
                reviewCount: 10,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({
                ...mockProduct,
                rating: 4.5,
                reviewCount: 11,
            });
            mockRepository.save.mockResolvedValue({
                ...mockProduct,
                rating: 4.5,
                reviewCount: 11,
            });
            const result = await productRepository.updateRating('123', 4.5, 11);
            expect(result.rating).toBe(4.5);
            expect(result.reviewCount).toBe(11);
        });
    });
    describe('incrementSoldCount', () => {
        it('should increment sold count', async () => {
            const mockProduct = {
                id: '123',
                soldCount: 10,
            };
            mockRepository.findOne.mockResolvedValue(mockProduct);
            mockRepository.merge.mockReturnValue({
                ...mockProduct,
                soldCount: 15,
            });
            mockRepository.save.mockResolvedValue({
                ...mockProduct,
                soldCount: 15,
            });
            const result = await productRepository.incrementSoldCount('123', 5);
            expect(result.soldCount).toBe(15);
        });
    });
    describe('findTopSelling', () => {
        it('should find top selling products', async () => {
            const mockProducts = [
                { id: '1', soldCount: 1000 },
                { id: '2', soldCount: 900 },
                { id: '3', soldCount: 800 },
            ];
            mockRepository.find.mockResolvedValue(mockProducts);
            const result = await productRepository.findTopSelling(10);
            expect(result).toEqual(mockProducts);
        });
        it('should limit results to specified count', async () => {
            const mockProducts = [
                { id: '1', soldCount: 1000 },
                { id: '2', soldCount: 900 },
            ];
            mockRepository.find.mockResolvedValue(mockProducts);
            await productRepository.findTopSelling(5);
            expect(mockRepository.find).toHaveBeenCalledWith(expect.objectContaining({
                take: 5,
            }));
        });
    });
    describe('findTopRated', () => {
        it('should find top rated products', async () => {
            const mockProducts = [
                { id: '1', rating: 4.9, reviewCount: 100 },
                { id: '2', rating: 4.8, reviewCount: 150 },
            ];
            mockRepository.find.mockResolvedValue(mockProducts);
            const result = await productRepository.findTopRated(10);
            expect(result).toEqual(mockProducts);
        });
        it('should only include products with minimum reviews', async () => {
            await productRepository.findTopRated(10, 5);
            expect(mockRepository.find).toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXEFkYXB0aXZlX1Rlc3RpbmdcXHNyY1xcc2VydmljZXNcXHByb2R1Y3QtY2F0YWxvZ1xccmVwb3NpdG9yaWVzXFxwcm9kdWN0LnJlcG9zaXRvcnkuc3BlYy50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7O0dBS0c7O0FBR0gsNkRBQXlEO0FBQ3pELCtEQUFvRTtBQUNwRSx5Q0FBNEQ7QUFFNUQsTUFBTSxjQUFjLEdBQUc7SUFDckIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNsQixZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUN2QixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNqQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNmLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2pCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2hCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2hCLGtCQUFrQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDN0IsUUFBUSxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRTtDQUNJLENBQUM7QUFFcEMsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtJQUNqQyxJQUFJLGlCQUFvQyxDQUFDO0lBRXpDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIsaUJBQWlCLEdBQUcsSUFBSSxzQ0FBaUIsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUM1RCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMxQyxNQUFNLFdBQVcsR0FBRztnQkFDbEIsRUFBRSxFQUFFLEtBQUs7Z0JBQ1QsR0FBRyxFQUFFLGNBQWM7Z0JB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Q25CLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUU7Z0JBQzFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUU7YUFDOUIsQ0FBQztZQUVkLGNBQWMsQ0FBQyxJQUFrQixDQUFDLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxDQUFDO1lBRW5FLE1BQU0sTUFBTSxHQUFHLE1BQU0saUJBQWlCLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBRXhELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDdkMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDakUsTUFBTSxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRTVDLE1BQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXEFkYXB0aXZlX1Rlc3RpbmdcXHNyY1xcc2VydmljZXNcXHByb2R1Y3QtY2F0YWxvZ1xccmVwb3NpdG9yaWVzXFxwcm9kdWN0LnJlcG9zaXRvcnkuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRERDogUHJvZHVjdCBSZXBvc2l0b3J5IFRlc3RzXG4gKlxuICogQ29tcHJlaGVuc2l2ZSB0ZXN0cyBmb3IgcHJvZHVjdCByZXBvc2l0b3J5IG9wZXJhdGlvbnNcbiAqIEZvbGxvd2luZyBzdHJpY3QgVEREOiBUZXN0cyB3cml0dGVuIGZpcnN0LCB0aGVuIGltcGxlbWVudGF0aW9uXG4gKi9cblxuaW1wb3J0IHsgUmVwb3NpdG9yeSB9IGZyb20gJ3R5cGVvcm0nO1xuaW1wb3J0IHsgUHJvZHVjdFJlcG9zaXRvcnkgfSBmcm9tICcuL3Byb2R1Y3QucmVwb3NpdG9yeSc7XG5pbXBvcnQgeyBQcm9kdWN0LCBQcm9kdWN0U3RhdHVzIH0gZnJvbSAnLi4vZW50aXRpZXMvcHJvZHVjdC5lbnRpdHknO1xuaW1wb3J0IHsgTm90Rm91bmRFcnJvciwgQ29uZmxpY3RFcnJvciB9IGZyb20gJ0BsaWJzL2Vycm9ycyc7XG5cbmNvbnN0IG1vY2tSZXBvc2l0b3J5ID0ge1xuICBmaW5kOiBqZXN0LmZuKCksXG4gIGZpbmRPbmU6IGplc3QuZm4oKSxcbiAgZmluZEFuZENvdW50OiBqZXN0LmZuKCksXG4gIGNyZWF0ZTogamVzdC5mbigpLFxuICBzYXZlOiBqZXN0LmZuKCksXG4gIHJlbW92ZTogamVzdC5mbigpLFxuICBjb3VudDogamVzdC5mbigpLFxuICBtZXJnZTogamVzdC5mbigpLFxuICBjcmVhdGVRdWVyeUJ1aWxkZXI6IGplc3QuZm4oKSxcbiAgbWV0YWRhdGE6IHsgbmFtZTogJ1Byb2R1Y3QnIH0sXG59IGFzIHVua25vd24gYXMgUmVwb3NpdG9yeTxQcm9kdWN0PjtcblxuZGVzY3JpYmUoJ1Byb2R1Y3RSZXBvc2l0b3J5JywgKCkgPT4ge1xuICBsZXQgcHJvZHVjdFJlcG9zaXRvcnk6IFByb2R1Y3RSZXBvc2l0b3J5O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIHByb2R1Y3RSZXBvc2l0b3J5ID0gbmV3IFByb2R1Y3RSZXBvc2l0b3J5KG1vY2tSZXBvc2l0b3J5KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRCeVNrdScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGZpbmQgcHJvZHVjdCBieSBTS1UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZHVjdCA9IHtcbiAgICAgICAgaWQ6ICcxMjMnLFxuICAgICAgICBza3U6ICdURVNULVNLVS0wMDEnLFxuICAgICAgICBuYW1lOiAnVGVzdCBQcm9kdWN0JyxcbiAgICAgIH0gYXMgUHJvZHVjdDtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZHVjdCk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb2R1Y3RSZXBvc2l0b3J5LmZpbmRCeVNrdSgnVEVTVC1TS1UtMDAxJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Byb2R1Y3QpO1xuICAgICAgZXhwZWN0KG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgd2hlcmU6IHsgc2t1OiAnVEVTVC1TS1UtMDAxJyB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBudWxsIGlmIHByb2R1Y3Qgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZmluZEJ5U2t1KCdOT04tRVhJU1RFTlQnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYmUgY2FzZS1zZW5zaXRpdmUgZm9yIFNLVScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0ID0geyBza3U6ICdURVNULVNLVS0wMDEnIH0gYXMgUHJvZHVjdDtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kT25lIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3QpO1xuXG4gICAgICBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5maW5kQnlTa3UoJ1RFU1QtU0tVLTAwMScpO1xuXG4gICAgICBleHBlY3QobW9ja1JlcG9zaXRvcnkuZmluZE9uZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICB3aGVyZTogeyBza3U6ICdURVNULVNLVS0wMDEnIH0sXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NrdUV4aXN0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIGlmIFNLVSBleGlzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAobW9ja1JlcG9zaXRvcnkuY291bnQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuc2t1RXhpc3RzKCdFWElTVElORy1TS1UnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGlmIFNLVSBkb2VzIG5vdCBleGlzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDApO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5za3VFeGlzdHMoJ05FVy1TS1UnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGVQcm9kdWN0JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbmV3IHByb2R1Y3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9kdWN0RGF0YSA9IHtcbiAgICAgICAgbmFtZTogJ05ldyBQcm9kdWN0JyxcbiAgICAgICAgc2t1OiAnTkVXLVNLVS0wMDEnLFxuICAgICAgICBwcmljZTogOTkuOTksXG4gICAgICAgIGludmVudG9yeTogMTAsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrUHJvZHVjdCA9IHsgaWQ6ICc0NTYnLCAuLi5wcm9kdWN0RGF0YSB9IGFzIFByb2R1Y3Q7XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDApO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5LmNyZWF0ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrUHJvZHVjdCk7XG4gICAgICAobW9ja1JlcG9zaXRvcnkuc2F2ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcm9kdWN0KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuY3JlYXRlUHJvZHVjdChwcm9kdWN0RGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja1Byb2R1Y3QpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBDb25mbGljdEVycm9yIGlmIFNLVSBhbHJlYWR5IGV4aXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHByb2R1Y3REYXRhID0ge1xuICAgICAgICBuYW1lOiAnUHJvZHVjdCcsXG4gICAgICAgIHNrdTogJ0VYSVNUSU5HLVNLVScsXG4gICAgICAgIHByaWNlOiA5OS45OSxcbiAgICAgIH07XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5jb3VudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKDEpO1xuXG4gICAgICBhd2FpdCBleHBlY3QocHJvZHVjdFJlcG9zaXRvcnkuY3JlYXRlUHJvZHVjdChwcm9kdWN0RGF0YSkpLnJlamVjdHMudG9UaHJvdyhDb25mbGljdEVycm9yKTtcbiAgICAgIGF3YWl0IGV4cGVjdChwcm9kdWN0UmVwb3NpdG9yeS5jcmVhdGVQcm9kdWN0KHByb2R1Y3REYXRhKSkucmVqZWN0cy50b1Rocm93KFxuICAgICAgICAnUHJvZHVjdCB3aXRoIHRoaXMgU0tVIGFscmVhZHkgZXhpc3RzJ1xuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2ZpbmRCeVN0YXR1cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGZpbmQgYWxsIHByb2R1Y3RzIHdpdGggc3BlY2lmaWVkIHN0YXR1cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0cyA9IFtcbiAgICAgICAgeyBpZDogJzEnLCBzdGF0dXM6IFByb2R1Y3RTdGF0dXMuQUNUSVZFIH0sXG4gICAgICAgIHsgaWQ6ICcyJywgc3RhdHVzOiBQcm9kdWN0U3RhdHVzLkFDVElWRSB9LFxuICAgICAgXSBhcyBQcm9kdWN0W107XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3RzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZmluZEJ5U3RhdHVzKFByb2R1Y3RTdGF0dXMuQUNUSVZFKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUHJvZHVjdHMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgaWYgbm8gcHJvZHVjdHMgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAobW9ja1JlcG9zaXRvcnkuZmluZCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZmluZEJ5U3RhdHVzKFByb2R1Y3RTdGF0dXMuRElTQ09OVElOVUVEKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbXSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kQnlDYXRlZ29yeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGZpbmQgYWxsIHByb2R1Y3RzIGluIGNhdGVnb3J5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Byb2R1Y3RzID0gW1xuICAgICAgICB7IGlkOiAnMScsIGNhdGVnb3J5SWQ6ICdjYXQtMTIzJyB9LFxuICAgICAgICB7IGlkOiAnMicsIGNhdGVnb3J5SWQ6ICdjYXQtMTIzJyB9LFxuICAgICAgXSBhcyBQcm9kdWN0W107XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3RzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZmluZEJ5Q2F0ZWdvcnkoJ2NhdC0xMjMnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUHJvZHVjdHMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgZm9yIGNhdGVnb3J5IHdpdGggbm8gcHJvZHVjdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAobW9ja1JlcG9zaXRvcnkuZmluZCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZmluZEJ5Q2F0ZWdvcnkoJ2VtcHR5LWNhdCcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKFtdKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwZGF0ZUludmVudG9yeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBwcm9kdWN0IGludmVudG9yeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RJZCA9ICcxMjMnO1xuICAgICAgY29uc3QgbmV3SW52ZW50b3J5ID0gNTA7XG4gICAgICBjb25zdCBtb2NrUHJvZHVjdCA9IHtcbiAgICAgICAgaWQ6IHByb2R1Y3RJZCxcbiAgICAgICAgaW52ZW50b3J5OiAxMCxcbiAgICAgIH0gYXMgUHJvZHVjdDtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZHVjdCk7XG4gICAgICAobW9ja1JlcG9zaXRvcnkubWVyZ2UgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAuLi5tb2NrUHJvZHVjdCxcbiAgICAgICAgaW52ZW50b3J5OiBuZXdJbnZlbnRvcnksXG4gICAgICB9KTtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5zYXZlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5tb2NrUHJvZHVjdCxcbiAgICAgICAgaW52ZW50b3J5OiBuZXdJbnZlbnRvcnksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkudXBkYXRlSW52ZW50b3J5KHByb2R1Y3RJZCwgbmV3SW52ZW50b3J5KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5pbnZlbnRvcnkpLnRvQmUobmV3SW52ZW50b3J5KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgTm90Rm91bmRFcnJvciBpZiBwcm9kdWN0IG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kT25lIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XG5cbiAgICAgIGF3YWl0IGV4cGVjdChwcm9kdWN0UmVwb3NpdG9yeS51cGRhdGVJbnZlbnRvcnkoJ25vbmV4aXN0ZW50JywgMTApKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgIE5vdEZvdW5kRXJyb3JcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHNldHRpbmcgaW52ZW50b3J5IHRvIHplcm8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZHVjdCA9IHsgaWQ6ICcxMjMnLCBpbnZlbnRvcnk6IDEwIH0gYXMgUHJvZHVjdDtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZHVjdCk7XG4gICAgICAobW9ja1JlcG9zaXRvcnkubWVyZ2UgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoeyAuLi5tb2NrUHJvZHVjdCwgaW52ZW50b3J5OiAwIH0pO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5LnNhdmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IC4uLm1vY2tQcm9kdWN0LCBpbnZlbnRvcnk6IDAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb2R1Y3RSZXBvc2l0b3J5LnVwZGF0ZUludmVudG9yeSgnMTIzJywgMCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuaW52ZW50b3J5KS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGVjcmVtZW50SW52ZW50b3J5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGVjcmVtZW50IGludmVudG9yeSBieSBxdWFudGl0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0ID0ge1xuICAgICAgICBpZDogJzEyMycsXG4gICAgICAgIGludmVudG9yeTogMTAwLFxuICAgICAgfSBhcyBQcm9kdWN0O1xuXG4gICAgICAobW9ja1JlcG9zaXRvcnkuZmluZE9uZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcm9kdWN0KTtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5tZXJnZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIC4uLm1vY2tQcm9kdWN0LFxuICAgICAgICBpbnZlbnRvcnk6IDk1LFxuICAgICAgfSk7XG4gICAgICAobW9ja1JlcG9zaXRvcnkuc2F2ZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1Byb2R1Y3QsXG4gICAgICAgIGludmVudG9yeTogOTUsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZGVjcmVtZW50SW52ZW50b3J5KCcxMjMnLCA1KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5pbnZlbnRvcnkpLnRvQmUoOTUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgYWxsb3cgbmVnYXRpdmUgaW52ZW50b3J5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Byb2R1Y3QgPSB7XG4gICAgICAgIGlkOiAnMTIzJyxcbiAgICAgICAgaW52ZW50b3J5OiA1LFxuICAgICAgfSBhcyBQcm9kdWN0O1xuXG4gICAgICAobW9ja1JlcG9zaXRvcnkuZmluZE9uZSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tQcm9kdWN0KTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHByb2R1Y3RSZXBvc2l0b3J5LmRlY3JlbWVudEludmVudG9yeSgnMTIzJywgMTApKS5yZWplY3RzLnRvVGhyb3coXG4gICAgICAgICdJbnN1ZmZpY2llbnQgaW52ZW50b3J5J1xuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGV4YWN0IGludmVudG9yeSBtYXRjaCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0ID0ge1xuICAgICAgICBpZDogJzEyMycsXG4gICAgICAgIGludmVudG9yeTogMTAsXG4gICAgICB9IGFzIFByb2R1Y3Q7XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kT25lIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3QpO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5Lm1lcmdlIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1Byb2R1Y3QsXG4gICAgICAgIGludmVudG9yeTogMCxcbiAgICAgIH0pO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5LnNhdmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIC4uLm1vY2tQcm9kdWN0LFxuICAgICAgICBpbnZlbnRvcnk6IDAsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZGVjcmVtZW50SW52ZW50b3J5KCcxMjMnLCAxMCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuaW52ZW50b3J5KS50b0JlKDApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaW5jcmVtZW50SW52ZW50b3J5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW5jcmVtZW50IGludmVudG9yeSBieSBxdWFudGl0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0ID0ge1xuICAgICAgICBpZDogJzEyMycsXG4gICAgICAgIGludmVudG9yeTogNTAsXG4gICAgICB9IGFzIFByb2R1Y3Q7XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kT25lIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3QpO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5Lm1lcmdlIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1Byb2R1Y3QsXG4gICAgICAgIGludmVudG9yeTogNzUsXG4gICAgICB9KTtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5zYXZlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5tb2NrUHJvZHVjdCxcbiAgICAgICAgaW52ZW50b3J5OiA3NSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5pbmNyZW1lbnRJbnZlbnRvcnkoJzEyMycsIDI1KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5pbnZlbnRvcnkpLnRvQmUoNzUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNyZW1lbnQgZnJvbSB6ZXJvIGludmVudG9yeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0ID0ge1xuICAgICAgICBpZDogJzEyMycsXG4gICAgICAgIGludmVudG9yeTogMCxcbiAgICAgIH0gYXMgUHJvZHVjdDtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmZpbmRPbmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZHVjdCk7XG4gICAgICAobW9ja1JlcG9zaXRvcnkubWVyZ2UgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAuLi5tb2NrUHJvZHVjdCxcbiAgICAgICAgaW52ZW50b3J5OiAxMCxcbiAgICAgIH0pO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5LnNhdmUgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIC4uLm1vY2tQcm9kdWN0LFxuICAgICAgICBpbnZlbnRvcnk6IDEwLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb2R1Y3RSZXBvc2l0b3J5LmluY3JlbWVudEludmVudG9yeSgnMTIzJywgMTApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmludmVudG9yeSkudG9CZSgxMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kTG93U3RvY2snLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmaW5kIHByb2R1Y3RzIHdpdGggaW52ZW50b3J5IGJlbG93IHRocmVzaG9sZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tCdWlsZGVyID0ge1xuICAgICAgICB3aGVyZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGFuZFdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgZ2V0TWFueTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgICB7IGlkOiAnMScsIGludmVudG9yeTogMyB9LFxuICAgICAgICAgIHsgaWQ6ICcyJywgaW52ZW50b3J5OiA1IH0sXG4gICAgICAgIF0pLFxuICAgICAgfTtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmNyZWF0ZVF1ZXJ5QnVpbGRlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrQnVpbGRlcik7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb2R1Y3RSZXBvc2l0b3J5LmZpbmRMb3dTdG9jaygxMCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgb25seSByZXR1cm4gYWN0aXZlIHByb2R1Y3RzIHdpdGggbG93IHN0b2NrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0J1aWxkZXIgPSB7XG4gICAgICAgIHdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgYW5kV2hlcmU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgICBnZXRNYW55OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW10pLFxuICAgICAgfTtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmNyZWF0ZVF1ZXJ5QnVpbGRlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrQnVpbGRlcik7XG5cbiAgICAgIGF3YWl0IHByb2R1Y3RSZXBvc2l0b3J5LmZpbmRMb3dTdG9jayg1KTtcblxuICAgICAgZXhwZWN0KG1vY2tCdWlsZGVyLndoZXJlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ3Byb2R1Y3Quc3RhdHVzID0gOnN0YXR1cycsXG4gICAgICAgIHsgc3RhdHVzOiBQcm9kdWN0U3RhdHVzLkFDVElWRSB9XG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZmluZE9uU2FsZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGZpbmQgcHJvZHVjdHMgb24gc2FsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tCdWlsZGVyID0ge1xuICAgICAgICB3aGVyZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGFuZFdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgZ2V0TWFueTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgICB7IGlkOiAnMScsIHByaWNlOiA3OS45OSwgY29tcGFyZUF0UHJpY2U6IDk5Ljk5IH0sXG4gICAgICAgICAgeyBpZDogJzInLCBwcmljZTogNDkuOTksIGNvbXBhcmVBdFByaWNlOiA3OS45OSB9LFxuICAgICAgICBdKSxcbiAgICAgIH07XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5jcmVhdGVRdWVyeUJ1aWxkZXIgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUobW9ja0J1aWxkZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5maW5kT25TYWxlKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlYXJjaFByb2R1Y3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2VhcmNoIHByb2R1Y3RzIGJ5IG5hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrQnVpbGRlciA9IHtcbiAgICAgICAgd2hlcmU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgICBhbmRXaGVyZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIG9yZGVyQnk6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgICBza2lwOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgdGFrZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGdldE1hbnlBbmRDb3VudDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgICBbeyBpZDogJzEnLCBuYW1lOiAnVGVzdCBQcm9kdWN0JyB9XSxcbiAgICAgICAgICAxLFxuICAgICAgICBdKSxcbiAgICAgIH07XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5jcmVhdGVRdWVyeUJ1aWxkZXIgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUobW9ja0J1aWxkZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5zZWFyY2hQcm9kdWN0cygndGVzdCcsIHt9KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5pdGVtcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC50b3RhbCkudG9CZSgxKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3VwcG9ydCBwYWdpbmF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0J1aWxkZXIgPSB7XG4gICAgICAgIHdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgYW5kV2hlcmU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgICBvcmRlckJ5OiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgc2tpcDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIHRha2U6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgICBnZXRNYW55QW5kQ291bnQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZShbW10sIDBdKSxcbiAgICAgIH07XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5jcmVhdGVRdWVyeUJ1aWxkZXIgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUobW9ja0J1aWxkZXIpO1xuXG4gICAgICBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5zZWFyY2hQcm9kdWN0cygncXVlcnknLCB7IHBhZ2U6IDIsIGxpbWl0OiAyMCB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tCdWlsZGVyLnNraXApLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDIwKTtcbiAgICAgIGV4cGVjdChtb2NrQnVpbGRlci50YWtlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbHRlciBieSBwcmljZSByYW5nZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tCdWlsZGVyID0ge1xuICAgICAgICB3aGVyZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGFuZFdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgb3JkZXJCeTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIHNraXA6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgICB0YWtlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgZ2V0TWFueUFuZENvdW50OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW1tdLCAwXSksXG4gICAgICB9O1xuXG4gICAgICAobW9ja1JlcG9zaXRvcnkuY3JlYXRlUXVlcnlCdWlsZGVyIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKG1vY2tCdWlsZGVyKTtcblxuICAgICAgYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuc2VhcmNoUHJvZHVjdHMoJ3F1ZXJ5Jywge1xuICAgICAgICBtaW5QcmljZTogMTAsXG4gICAgICAgIG1heFByaWNlOiAxMDAsXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tCdWlsZGVyLmFuZFdoZXJlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbHRlciBieSBjYXRlZ29yeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tCdWlsZGVyID0ge1xuICAgICAgICB3aGVyZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGFuZFdoZXJlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgb3JkZXJCeTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIHNraXA6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgICB0YWtlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgICAgZ2V0TWFueUFuZENvdW50OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoW1tdLCAwXSksXG4gICAgICB9O1xuXG4gICAgICAobW9ja1JlcG9zaXRvcnkuY3JlYXRlUXVlcnlCdWlsZGVyIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKG1vY2tCdWlsZGVyKTtcblxuICAgICAgYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuc2VhcmNoUHJvZHVjdHMoJ3F1ZXJ5Jywge1xuICAgICAgICBjYXRlZ29yeUlkOiAnY2F0LTEyMycsXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tCdWlsZGVyLmFuZFdoZXJlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGVSYXRpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgcHJvZHVjdCByYXRpbmcgYW5kIHJldmlldyBjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0ID0ge1xuICAgICAgICBpZDogJzEyMycsXG4gICAgICAgIHJhdGluZzogNC4wLFxuICAgICAgICByZXZpZXdDb3VudDogMTAsXG4gICAgICB9IGFzIFByb2R1Y3Q7XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kT25lIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3QpO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5Lm1lcmdlIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1Byb2R1Y3QsXG4gICAgICAgIHJhdGluZzogNC41LFxuICAgICAgICByZXZpZXdDb3VudDogMTEsXG4gICAgICB9KTtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5zYXZlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5tb2NrUHJvZHVjdCxcbiAgICAgICAgcmF0aW5nOiA0LjUsXG4gICAgICAgIHJldmlld0NvdW50OiAxMSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS51cGRhdGVSYXRpbmcoJzEyMycsIDQuNSwgMTEpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnJhdGluZykudG9CZSg0LjUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZXZpZXdDb3VudCkudG9CZSgxMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpbmNyZW1lbnRTb2xkQ291bnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbmNyZW1lbnQgc29sZCBjb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0ID0ge1xuICAgICAgICBpZDogJzEyMycsXG4gICAgICAgIHNvbGRDb3VudDogMTAsXG4gICAgICB9IGFzIFByb2R1Y3Q7XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kT25lIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3QpO1xuICAgICAgKG1vY2tSZXBvc2l0b3J5Lm1lcmdlIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgLi4ubW9ja1Byb2R1Y3QsXG4gICAgICAgIHNvbGRDb3VudDogMTUsXG4gICAgICB9KTtcbiAgICAgIChtb2NrUmVwb3NpdG9yeS5zYXZlIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAuLi5tb2NrUHJvZHVjdCxcbiAgICAgICAgc29sZENvdW50OiAxNSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5pbmNyZW1lbnRTb2xkQ291bnQoJzEyMycsIDUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnNvbGRDb3VudCkudG9CZSgxNSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kVG9wU2VsbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGZpbmQgdG9wIHNlbGxpbmcgcHJvZHVjdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUHJvZHVjdHMgPSBbXG4gICAgICAgIHsgaWQ6ICcxJywgc29sZENvdW50OiAxMDAwIH0sXG4gICAgICAgIHsgaWQ6ICcyJywgc29sZENvdW50OiA5MDAgfSxcbiAgICAgICAgeyBpZDogJzMnLCBzb2xkQ291bnQ6IDgwMCB9LFxuICAgICAgXSBhcyBQcm9kdWN0W107XG5cbiAgICAgIChtb2NrUmVwb3NpdG9yeS5maW5kIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Byb2R1Y3RzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvZHVjdFJlcG9zaXRvcnkuZmluZFRvcFNlbGxpbmcoMTApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tQcm9kdWN0cyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxpbWl0IHJlc3VsdHMgdG8gc3BlY2lmaWVkIGNvdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Byb2R1Y3RzID0gW1xuICAgICAgICB7IGlkOiAnMScsIHNvbGRDb3VudDogMTAwMCB9LFxuICAgICAgICB7IGlkOiAnMicsIHNvbGRDb3VudDogOTAwIH0sXG4gICAgICBdIGFzIFByb2R1Y3RbXTtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmZpbmQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZHVjdHMpO1xuXG4gICAgICBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5maW5kVG9wU2VsbGluZyg1KTtcblxuICAgICAgZXhwZWN0KG1vY2tSZXBvc2l0b3J5LmZpbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgdGFrZTogNSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmaW5kVG9wUmF0ZWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmaW5kIHRvcCByYXRlZCBwcm9kdWN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0cyA9IFtcbiAgICAgICAgeyBpZDogJzEnLCByYXRpbmc6IDQuOSwgcmV2aWV3Q291bnQ6IDEwMCB9LFxuICAgICAgICB7IGlkOiAnMicsIHJhdGluZzogNC44LCByZXZpZXdDb3VudDogMTUwIH0sXG4gICAgICBdIGFzIFByb2R1Y3RbXTtcblxuICAgICAgKG1vY2tSZXBvc2l0b3J5LmZpbmQgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUHJvZHVjdHMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9kdWN0UmVwb3NpdG9yeS5maW5kVG9wUmF0ZWQoMTApO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tQcm9kdWN0cyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG9ubHkgaW5jbHVkZSBwcm9kdWN0cyB3aXRoIG1pbmltdW0gcmV2aWV3cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHByb2R1Y3RSZXBvc2l0b3J5LmZpbmRUb3BSYXRlZCgxMCwgNSk7XG5cbiAgICAgIGV4cGVjdChtb2NrUmVwb3NpdG9yeS5maW5kKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=