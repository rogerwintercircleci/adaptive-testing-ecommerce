1a21a40e3489357a2b2d8ff004e54280
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.User = exports.UserStatus = exports.UserRole = void 0;
const typeorm_1 = require("typeorm");
var UserRole;
(function (UserRole) {
    UserRole["ADMIN"] = "admin";
    UserRole["CUSTOMER"] = "customer";
    UserRole["VENDOR"] = "vendor";
})(UserRole || (exports.UserRole = UserRole = {}));
var UserStatus;
(function (UserStatus) {
    UserStatus["PENDING"] = "pending";
    UserStatus["ACTIVE"] = "active";
    UserStatus["SUSPENDED"] = "suspended";
    UserStatus["DELETED"] = "deleted";
})(UserStatus || (exports.UserStatus = UserStatus = {}));
let User = class User {
    id;
    email;
    password;
    firstName;
    lastName;
    role;
    status;
    phoneNumber;
    emailVerificationToken;
    emailVerifiedAt;
    passwordResetToken;
    passwordResetExpires;
    lastLoginAt;
    loginAttempts;
    lockedUntil;
    createdAt;
    updatedAt;
    deletedAt;
    /**
     * Get full name
     */
    get fullName() {
        return `${this.firstName} ${this.lastName}`;
    }
    /**
     * Check if email is verified
     */
    isEmailVerified() {
        return this.emailVerifiedAt !== null && this.emailVerifiedAt !== undefined;
    }
    /**
     * Check if account is locked
     */
    isLocked() {
        if (!this.lockedUntil) {
            return false;
        }
        return this.lockedUntil > new Date();
    }
    /**
     * Check if user is active
     */
    isActive() {
        return this.status === UserStatus.ACTIVE && !this.isLocked();
    }
    /**
     * Sanitize user data (remove sensitive fields)
     */
    toJSON() {
        const { password, emailVerificationToken, passwordResetToken, ...sanitized } = this;
        return sanitized;
    }
};
exports.User = User;
__decorate([
    (0, typeorm_1.PrimaryGeneratedColumn)('uuid'),
    __metadata("design:type", String)
], User.prototype, "id", void 0);
__decorate([
    (0, typeorm_1.Column)({ unique: true }),
    (0, typeorm_1.Index)(),
    __metadata("design:type", String)
], User.prototype, "email", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    __metadata("design:type", String)
], User.prototype, "password", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    __metadata("design:type", String)
], User.prototype, "firstName", void 0);
__decorate([
    (0, typeorm_1.Column)(),
    __metadata("design:type", String)
], User.prototype, "lastName", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: UserRole,
        default: UserRole.CUSTOMER,
    }),
    __metadata("design:type", String)
], User.prototype, "role", void 0);
__decorate([
    (0, typeorm_1.Column)({
        type: 'enum',
        enum: UserStatus,
        default: UserStatus.PENDING,
    }),
    __metadata("design:type", String)
], User.prototype, "status", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true }),
    __metadata("design:type", String)
], User.prototype, "phoneNumber", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true }),
    (0, typeorm_1.Index)(),
    __metadata("design:type", String)
], User.prototype, "emailVerificationToken", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'timestamp', nullable: true }),
    __metadata("design:type", Date)
], User.prototype, "emailVerifiedAt", void 0);
__decorate([
    (0, typeorm_1.Column)({ nullable: true }),
    __metadata("design:type", String)
], User.prototype, "passwordResetToken", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'timestamp', nullable: true }),
    __metadata("design:type", Date)
], User.prototype, "passwordResetExpires", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'timestamp', nullable: true }),
    __metadata("design:type", Date)
], User.prototype, "lastLoginAt", void 0);
__decorate([
    (0, typeorm_1.Column)({ default: 0 }),
    __metadata("design:type", Number)
], User.prototype, "loginAttempts", void 0);
__decorate([
    (0, typeorm_1.Column)({ type: 'timestamp', nullable: true }),
    __metadata("design:type", Date)
], User.prototype, "lockedUntil", void 0);
__decorate([
    (0, typeorm_1.CreateDateColumn)(),
    __metadata("design:type", Date)
], User.prototype, "createdAt", void 0);
__decorate([
    (0, typeorm_1.UpdateDateColumn)(),
    __metadata("design:type", Date)
], User.prototype, "updatedAt", void 0);
__decorate([
    (0, typeorm_1.DeleteDateColumn)(),
    __metadata("design:type", Date)
], User.prototype, "deletedAt", void 0);
exports.User = User = __decorate([
    (0, typeorm_1.Entity)('users')
], User);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXEFkYXB0aXZlX1Rlc3RpbmdcXHNyY1xcc2VydmljZXNcXHVzZXItbWFuYWdlbWVudFxcZW50aXRpZXNcXHVzZXIuZW50aXR5LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLHFDQVFpQjtBQUVqQixJQUFZLFFBSVg7QUFKRCxXQUFZLFFBQVE7SUFDbEIsMkJBQWUsQ0FBQTtJQUNmLGlDQUFxQixDQUFBO0lBQ3JCLDZCQUFpQixDQUFBO0FBQ25CLENBQUMsRUFKVyxRQUFRLHdCQUFSLFFBQVEsUUFJbkI7QUFFRCxJQUFZLFVBS1g7QUFMRCxXQUFZLFVBQVU7SUFDcEIsaUNBQW1CLENBQUE7SUFDbkIsK0JBQWlCLENBQUE7SUFDakIscUNBQXVCLENBQUE7SUFDdkIsaUNBQW1CLENBQUE7QUFDckIsQ0FBQyxFQUxXLFVBQVUsMEJBQVYsVUFBVSxRQUtyQjtBQUdNLElBQU0sSUFBSSxHQUFWLE1BQU0sSUFBSTtJQUVmLEVBQUUsQ0FBVTtJQUlaLEtBQUssQ0FBVTtJQUdmLFFBQVEsQ0FBVTtJQUdsQixTQUFTLENBQVU7SUFHbkIsUUFBUSxDQUFVO0lBT2xCLElBQUksQ0FBWTtJQU9oQixNQUFNLENBQWM7SUFHcEIsV0FBVyxDQUFVO0lBSXJCLHNCQUFzQixDQUFVO0lBR2hDLGVBQWUsQ0FBUTtJQUd2QixrQkFBa0IsQ0FBVTtJQUc1QixvQkFBb0IsQ0FBUTtJQUc1QixXQUFXLENBQVE7SUFHbkIsYUFBYSxDQUFVO0lBR3ZCLFdBQVcsQ0FBUTtJQUduQixTQUFTLENBQVE7SUFHakIsU0FBUyxDQUFRO0lBR2pCLFNBQVMsQ0FBUTtJQUVqQjs7T0FFRztJQUNILElBQUksUUFBUTtRQUNWLE9BQU8sR0FBRyxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUM5QyxDQUFDO0lBRUQ7O09BRUc7SUFDSCxlQUFlO1FBQ2IsT0FBTyxJQUFJLENBQUMsZUFBZSxLQUFLLElBQUksSUFBSSxJQUFJLENBQUMsZUFBZSxLQUFLLFNBQVMsQ0FBQztJQUM3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XFx1c2VyLW1hbmFnZW1lbnRcXGVudGl0aWVzXFx1c2VyLmVudGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBFbnRpdHksXG4gIFByaW1hcnlHZW5lcmF0ZWRDb2x1bW4sXG4gIENvbHVtbixcbiAgQ3JlYXRlRGF0ZUNvbHVtbixcbiAgVXBkYXRlRGF0ZUNvbHVtbixcbiAgRGVsZXRlRGF0ZUNvbHVtbixcbiAgSW5kZXgsXG59IGZyb20gJ3R5cGVvcm0nO1xuXG5leHBvcnQgZW51bSBVc2VyUm9sZSB7XG4gIEFETUlOID0gJ2FkbWluJyxcbiAgQ1VTVE9NRVIgPSAnY3VzdG9tZXInLFxuICBWRU5ET1IgPSAndmVuZG9yJyxcbn1cblxuZXhwb3J0IGVudW0gVXNlclN0YXR1cyB7XG4gIFBFTkRJTkcgPSAncGVuZGluZycsXG4gIEFDVElWRSA9ICdhY3RpdmUnLFxuICBTVVNQRU5ERUQgPSAnc3VzcGVuZGVkJyxcbiAgREVMRVRFRCA9ICdkZWxldGVkJyxcbn1cblxuQEVudGl0eSgndXNlcnMnKVxuZXhwb3J0IGNsYXNzIFVzZXIge1xuICBAUHJpbWFyeUdlbmVyYXRlZENvbHVtbigndXVpZCcpXG4gIGlkITogc3RyaW5nO1xuXG4gIEBDb2x1bW4oeyB1bmlxdWU6IHRydWUgfSlcbiAgQEluZGV4KClcbiAgZW1haWwhOiBzdHJpbmc7XG5cbiAgQENvbHVtbigpXG4gIHBhc3N3b3JkITogc3RyaW5nO1xuXG4gIEBDb2x1bW4oKVxuICBmaXJzdE5hbWUhOiBzdHJpbmc7XG5cbiAgQENvbHVtbigpXG4gIGxhc3ROYW1lITogc3RyaW5nO1xuXG4gIEBDb2x1bW4oe1xuICAgIHR5cGU6ICdlbnVtJyxcbiAgICBlbnVtOiBVc2VyUm9sZSxcbiAgICBkZWZhdWx0OiBVc2VyUm9sZS5DVVNUT01FUixcbiAgfSlcbiAgcm9sZSE6IFVzZXJSb2xlO1xuXG4gIEBDb2x1bW4oe1xuICAgIHR5cGU6ICdlbnVtJyxcbiAgICBlbnVtOiBVc2VyU3RhdHVzLFxuICAgIGRlZmF1bHQ6IFVzZXJTdGF0dXMuUEVORElORyxcbiAgfSlcbiAgc3RhdHVzITogVXNlclN0YXR1cztcblxuICBAQ29sdW1uKHsgbnVsbGFibGU6IHRydWUgfSlcbiAgcGhvbmVOdW1iZXI/OiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IG51bGxhYmxlOiB0cnVlIH0pXG4gIEBJbmRleCgpXG4gIGVtYWlsVmVyaWZpY2F0aW9uVG9rZW4/OiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd0aW1lc3RhbXAnLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBlbWFpbFZlcmlmaWVkQXQ/OiBEYXRlO1xuXG4gIEBDb2x1bW4oeyBudWxsYWJsZTogdHJ1ZSB9KVxuICBwYXNzd29yZFJlc2V0VG9rZW4/OiBzdHJpbmc7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd0aW1lc3RhbXAnLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBwYXNzd29yZFJlc2V0RXhwaXJlcz86IERhdGU7XG5cbiAgQENvbHVtbih7IHR5cGU6ICd0aW1lc3RhbXAnLCBudWxsYWJsZTogdHJ1ZSB9KVxuICBsYXN0TG9naW5BdD86IERhdGU7XG5cbiAgQENvbHVtbih7IGRlZmF1bHQ6IDAgfSlcbiAgbG9naW5BdHRlbXB0cyE6IG51bWJlcjtcblxuICBAQ29sdW1uKHsgdHlwZTogJ3RpbWVzdGFtcCcsIG51bGxhYmxlOiB0cnVlIH0pXG4gIGxvY2tlZFVudGlsPzogRGF0ZTtcblxuICBAQ3JlYXRlRGF0ZUNvbHVtbigpXG4gIGNyZWF0ZWRBdCE6IERhdGU7XG5cbiAgQFVwZGF0ZURhdGVDb2x1bW4oKVxuICB1cGRhdGVkQXQhOiBEYXRlO1xuXG4gIEBEZWxldGVEYXRlQ29sdW1uKClcbiAgZGVsZXRlZEF0PzogRGF0ZTtcblxuICAvKipcbiAgICogR2V0IGZ1bGwgbmFtZVxuICAgKi9cbiAgZ2V0IGZ1bGxOYW1lKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke3RoaXMuZmlyc3ROYW1lfSAke3RoaXMubGFzdE5hbWV9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBlbWFpbCBpcyB2ZXJpZmllZFxuICAgKi9cbiAgaXNFbWFpbFZlcmlmaWVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmVtYWlsVmVyaWZpZWRBdCAhPT0gbnVsbCAmJiB0aGlzLmVtYWlsVmVyaWZpZWRBdCAhPT0gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGFjY291bnQgaXMgbG9ja2VkXG4gICAqL1xuICBpc0xvY2tlZCgpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMubG9ja2VkVW50aWwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMubG9ja2VkVW50aWwgPiBuZXcgRGF0ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHVzZXIgaXMgYWN0aXZlXG4gICAqL1xuICBpc0FjdGl2ZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IFVzZXJTdGF0dXMuQUNUSVZFICYmICF0aGlzLmlzTG9ja2VkKCk7XG4gIH1cblxuICAvKipcbiAgICogU2FuaXRpemUgdXNlciBkYXRhIChyZW1vdmUgc2Vuc2l0aXZlIGZpZWxkcylcbiAgICovXG4gIHRvSlNPTigpOiBQYXJ0aWFsPFVzZXI+IHtcbiAgICBjb25zdCB7IHBhc3N3b3JkLCBlbWFpbFZlcmlmaWNhdGlvblRva2VuLCBwYXNzd29yZFJlc2V0VG9rZW4sIC4uLnNhbml0aXplZCB9ID0gdGhpcztcbiAgICByZXR1cm4gc2FuaXRpemVkO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=