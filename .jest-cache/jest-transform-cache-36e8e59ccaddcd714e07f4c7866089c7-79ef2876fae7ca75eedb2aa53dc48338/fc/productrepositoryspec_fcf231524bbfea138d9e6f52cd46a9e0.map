{"file":"C:\\Adaptive_Testing\\src\\services\\product-catalog\\repositories\\product.repository.spec.ts","mappings":"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","names":[],"sources":["C:\\Adaptive_Testing\\src\\services\\product-catalog\\repositories\\product.repository.spec.ts"],"sourcesContent":["/**\n * TDD: Product Repository Tests\n *\n * Comprehensive tests for product repository operations\n * Following strict TDD: Tests written first, then implementation\n */\n\nimport { Repository } from 'typeorm';\nimport { ProductRepository } from './product.repository';\nimport { Product, ProductStatus } from '../entities/product.entity';\nimport { NotFoundError, ConflictError } from '@libs/errors';\n\nconst mockRepository = {\n  find: jest.fn(),\n  findOne: jest.fn(),\n  findAndCount: jest.fn(),\n  create: jest.fn(),\n  save: jest.fn(),\n  remove: jest.fn(),\n  count: jest.fn(),\n  merge: jest.fn(),\n  createQueryBuilder: jest.fn(),\n  metadata: { name: 'Product' },\n} as unknown as Repository<Product>;\n\ndescribe('ProductRepository', () => {\n  let productRepository: ProductRepository;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    productRepository = new ProductRepository(mockRepository);\n  });\n\n  describe('findBySku', () => {\n    it('should find product by SKU', async () => {\n      const mockProduct = {\n        id: '123',\n        sku: 'TEST-SKU-001',\n        name: 'Test Product',\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n\n      const result = await productRepository.findBySku('TEST-SKU-001');\n\n      expect(result).toEqual(mockProduct);\n      expect(mockRepository.findOne).toHaveBeenCalledWith({\n        where: { sku: 'TEST-SKU-001' },\n      });\n    });\n\n    it('should return null if product not found', async () => {\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(null);\n\n      const result = await productRepository.findBySku('NON-EXISTENT');\n\n      expect(result).toBeNull();\n    });\n\n    it('should be case-sensitive for SKU', async () => {\n      const mockProduct = { sku: 'TEST-SKU-001' } as Product;\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n\n      await productRepository.findBySku('TEST-SKU-001');\n\n      expect(mockRepository.findOne).toHaveBeenCalledWith({\n        where: { sku: 'TEST-SKU-001' },\n      });\n    });\n  });\n\n  describe('skuExists', () => {\n    it('should return true if SKU exists', async () => {\n      (mockRepository.count as jest.Mock).mockResolvedValue(1);\n\n      const result = await productRepository.skuExists('EXISTING-SKU');\n\n      expect(result).toBe(true);\n    });\n\n    it('should return false if SKU does not exist', async () => {\n      (mockRepository.count as jest.Mock).mockResolvedValue(0);\n\n      const result = await productRepository.skuExists('NEW-SKU');\n\n      expect(result).toBe(false);\n    });\n  });\n\n  describe('createProduct', () => {\n    it('should create a new product', async () => {\n      const productData = {\n        name: 'New Product',\n        sku: 'NEW-SKU-001',\n        price: 99.99,\n        inventory: 10,\n      };\n\n      const mockProduct = { id: '456', ...productData } as Product;\n\n      (mockRepository.count as jest.Mock).mockResolvedValue(0);\n      (mockRepository.create as jest.Mock).mockReturnValue(mockProduct);\n      (mockRepository.save as jest.Mock).mockResolvedValue(mockProduct);\n\n      const result = await productRepository.createProduct(productData);\n\n      expect(result).toEqual(mockProduct);\n    });\n\n    it('should throw ConflictError if SKU already exists', async () => {\n      const productData = {\n        name: 'Product',\n        sku: 'EXISTING-SKU',\n        price: 99.99,\n      };\n\n      (mockRepository.count as jest.Mock).mockResolvedValue(1);\n\n      await expect(productRepository.createProduct(productData)).rejects.toThrow(ConflictError);\n      await expect(productRepository.createProduct(productData)).rejects.toThrow(\n        'Product with this SKU already exists'\n      );\n    });\n  });\n\n  describe('findByStatus', () => {\n    it('should find all products with specified status', async () => {\n      const mockProducts = [\n        { id: '1', status: ProductStatus.ACTIVE },\n        { id: '2', status: ProductStatus.ACTIVE },\n      ] as Product[];\n\n      (mockRepository.find as jest.Mock).mockResolvedValue(mockProducts);\n\n      const result = await productRepository.findByStatus(ProductStatus.ACTIVE);\n\n      expect(result).toEqual(mockProducts);\n    });\n\n    it('should return empty array if no products found', async () => {\n      (mockRepository.find as jest.Mock).mockResolvedValue([]);\n\n      const result = await productRepository.findByStatus(ProductStatus.DISCONTINUED);\n\n      expect(result).toEqual([]);\n    });\n  });\n\n  describe('findByCategory', () => {\n    it('should find all products in category', async () => {\n      const mockProducts = [\n        { id: '1', categoryId: 'cat-123' },\n        { id: '2', categoryId: 'cat-123' },\n      ] as Product[];\n\n      (mockRepository.find as jest.Mock).mockResolvedValue(mockProducts);\n\n      const result = await productRepository.findByCategory('cat-123');\n\n      expect(result).toEqual(mockProducts);\n    });\n\n    it('should return empty array for category with no products', async () => {\n      (mockRepository.find as jest.Mock).mockResolvedValue([]);\n\n      const result = await productRepository.findByCategory('empty-cat');\n\n      expect(result).toEqual([]);\n    });\n  });\n\n  describe('updateInventory', () => {\n    it('should update product inventory', async () => {\n      const productId = '123';\n      const newInventory = 50;\n      const mockProduct = {\n        id: productId,\n        inventory: 10,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({\n        ...mockProduct,\n        inventory: newInventory,\n      });\n      (mockRepository.save as jest.Mock).mockResolvedValue({\n        ...mockProduct,\n        inventory: newInventory,\n      });\n\n      const result = await productRepository.updateInventory(productId, newInventory);\n\n      expect(result.inventory).toBe(newInventory);\n    });\n\n    it('should throw NotFoundError if product not found', async () => {\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(null);\n\n      await expect(productRepository.updateInventory('nonexistent', 10)).rejects.toThrow(\n        NotFoundError\n      );\n    });\n\n    it('should allow setting inventory to zero', async () => {\n      const mockProduct = { id: '123', inventory: 10 } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({ ...mockProduct, inventory: 0 });\n      (mockRepository.save as jest.Mock).mockResolvedValue({ ...mockProduct, inventory: 0 });\n\n      const result = await productRepository.updateInventory('123', 0);\n\n      expect(result.inventory).toBe(0);\n    });\n  });\n\n  describe('decrementInventory', () => {\n    it('should decrement inventory by quantity', async () => {\n      const mockProduct = {\n        id: '123',\n        inventory: 100,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({\n        ...mockProduct,\n        inventory: 95,\n      });\n      (mockRepository.save as jest.Mock).mockResolvedValue({\n        ...mockProduct,\n        inventory: 95,\n      });\n\n      const result = await productRepository.decrementInventory('123', 5);\n\n      expect(result.inventory).toBe(95);\n    });\n\n    it('should not allow negative inventory', async () => {\n      const mockProduct = {\n        id: '123',\n        inventory: 5,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n\n      await expect(productRepository.decrementInventory('123', 10)).rejects.toThrow(\n        'Insufficient inventory'\n      );\n    });\n\n    it('should handle exact inventory match', async () => {\n      const mockProduct = {\n        id: '123',\n        inventory: 10,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({\n        ...mockProduct,\n        inventory: 0,\n      });\n      (mockRepository.save as jest.Mock).mockResolvedValue({\n        ...mockProduct,\n        inventory: 0,\n      });\n\n      const result = await productRepository.decrementInventory('123', 10);\n\n      expect(result.inventory).toBe(0);\n    });\n  });\n\n  describe('incrementInventory', () => {\n    it('should increment inventory by quantity', async () => {\n      const mockProduct = {\n        id: '123',\n        inventory: 50,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({\n        ...mockProduct,\n        inventory: 75,\n      });\n      (mockRepository.save as jest.Mock).mockResolvedValue({\n        ...mockProduct,\n        inventory: 75,\n      });\n\n      const result = await productRepository.incrementInventory('123', 25);\n\n      expect(result.inventory).toBe(75);\n    });\n\n    it('should increment from zero inventory', async () => {\n      const mockProduct = {\n        id: '123',\n        inventory: 0,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({\n        ...mockProduct,\n        inventory: 10,\n      });\n      (mockRepository.save as jest.Mock).mockResolvedValue({\n        ...mockProduct,\n        inventory: 10,\n      });\n\n      const result = await productRepository.incrementInventory('123', 10);\n\n      expect(result.inventory).toBe(10);\n    });\n  });\n\n  describe('findLowStock', () => {\n    it('should find products with inventory below threshold', async () => {\n      const mockBuilder = {\n        where: jest.fn().mockReturnThis(),\n        andWhere: jest.fn().mockReturnThis(),\n        getMany: jest.fn().mockResolvedValue([\n          { id: '1', inventory: 3 },\n          { id: '2', inventory: 5 },\n        ]),\n      };\n\n      (mockRepository.createQueryBuilder as jest.Mock).mockReturnValue(mockBuilder);\n\n      const result = await productRepository.findLowStock(10);\n\n      expect(result).toHaveLength(2);\n    });\n\n    it('should only return active products with low stock', async () => {\n      const mockBuilder = {\n        where: jest.fn().mockReturnThis(),\n        andWhere: jest.fn().mockReturnThis(),\n        getMany: jest.fn().mockResolvedValue([]),\n      };\n\n      (mockRepository.createQueryBuilder as jest.Mock).mockReturnValue(mockBuilder);\n\n      await productRepository.findLowStock(5);\n\n      expect(mockBuilder.where).toHaveBeenCalledWith(\n        'product.status = :status',\n        { status: ProductStatus.ACTIVE }\n      );\n    });\n  });\n\n  describe('findOnSale', () => {\n    it('should find products on sale', async () => {\n      const mockBuilder = {\n        where: jest.fn().mockReturnThis(),\n        andWhere: jest.fn().mockReturnThis(),\n        getMany: jest.fn().mockResolvedValue([\n          { id: '1', price: 79.99, compareAtPrice: 99.99 },\n          { id: '2', price: 49.99, compareAtPrice: 79.99 },\n        ]),\n      };\n\n      (mockRepository.createQueryBuilder as jest.Mock).mockReturnValue(mockBuilder);\n\n      const result = await productRepository.findOnSale();\n\n      expect(result).toHaveLength(2);\n    });\n  });\n\n  describe('searchProducts', () => {\n    it('should search products by name', async () => {\n      const mockBuilder = {\n        where: jest.fn().mockReturnThis(),\n        andWhere: jest.fn().mockReturnThis(),\n        orderBy: jest.fn().mockReturnThis(),\n        skip: jest.fn().mockReturnThis(),\n        take: jest.fn().mockReturnThis(),\n        getManyAndCount: jest.fn().mockResolvedValue([\n          [{ id: '1', name: 'Test Product' }],\n          1,\n        ]),\n      };\n\n      (mockRepository.createQueryBuilder as jest.Mock).mockReturnValue(mockBuilder);\n\n      const result = await productRepository.searchProducts('test', {});\n\n      expect(result.items).toHaveLength(1);\n      expect(result.total).toBe(1);\n    });\n\n    it('should support pagination', async () => {\n      const mockBuilder = {\n        where: jest.fn().mockReturnThis(),\n        andWhere: jest.fn().mockReturnThis(),\n        orderBy: jest.fn().mockReturnThis(),\n        skip: jest.fn().mockReturnThis(),\n        take: jest.fn().mockReturnThis(),\n        getManyAndCount: jest.fn().mockResolvedValue([[], 0]),\n      };\n\n      (mockRepository.createQueryBuilder as jest.Mock).mockReturnValue(mockBuilder);\n\n      await productRepository.searchProducts('query', { page: 2, limit: 20 });\n\n      expect(mockBuilder.skip).toHaveBeenCalledWith(20);\n      expect(mockBuilder.take).toHaveBeenCalledWith(20);\n    });\n\n    it('should filter by price range', async () => {\n      const mockBuilder = {\n        where: jest.fn().mockReturnThis(),\n        andWhere: jest.fn().mockReturnThis(),\n        orderBy: jest.fn().mockReturnThis(),\n        skip: jest.fn().mockReturnThis(),\n        take: jest.fn().mockReturnThis(),\n        getManyAndCount: jest.fn().mockResolvedValue([[], 0]),\n      };\n\n      (mockRepository.createQueryBuilder as jest.Mock).mockReturnValue(mockBuilder);\n\n      await productRepository.searchProducts('query', {\n        minPrice: 10,\n        maxPrice: 100,\n      });\n\n      expect(mockBuilder.andWhere).toHaveBeenCalled();\n    });\n\n    it('should filter by category', async () => {\n      const mockBuilder = {\n        where: jest.fn().mockReturnThis(),\n        andWhere: jest.fn().mockReturnThis(),\n        orderBy: jest.fn().mockReturnThis(),\n        skip: jest.fn().mockReturnThis(),\n        take: jest.fn().mockReturnThis(),\n        getManyAndCount: jest.fn().mockResolvedValue([[], 0]),\n      };\n\n      (mockRepository.createQueryBuilder as jest.Mock).mockReturnValue(mockBuilder);\n\n      await productRepository.searchProducts('query', {\n        categoryId: 'cat-123',\n      });\n\n      expect(mockBuilder.andWhere).toHaveBeenCalled();\n    });\n  });\n\n  describe('updateRating', () => {\n    it('should update product rating and review count', async () => {\n      const mockProduct = {\n        id: '123',\n        rating: 4.0,\n        reviewCount: 10,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({\n        ...mockProduct,\n        rating: 4.5,\n        reviewCount: 11,\n      });\n      (mockRepository.save as jest.Mock).mockResolvedValue({\n        ...mockProduct,\n        rating: 4.5,\n        reviewCount: 11,\n      });\n\n      const result = await productRepository.updateRating('123', 4.5, 11);\n\n      expect(result.rating).toBe(4.5);\n      expect(result.reviewCount).toBe(11);\n    });\n  });\n\n  describe('incrementSoldCount', () => {\n    it('should increment sold count', async () => {\n      const mockProduct = {\n        id: '123',\n        soldCount: 10,\n      } as Product;\n\n      (mockRepository.findOne as jest.Mock).mockResolvedValue(mockProduct);\n      (mockRepository.merge as jest.Mock).mockReturnValue({\n        ...mockProduct,\n        soldCount: 15,\n      });\n      (mockRepository.save as jest.Mock).mockResolvedValue({\n        ...mockProduct,\n        soldCount: 15,\n      });\n\n      const result = await productRepository.incrementSoldCount('123', 5);\n\n      expect(result.soldCount).toBe(15);\n    });\n  });\n\n  describe('findTopSelling', () => {\n    it('should find top selling products', async () => {\n      const mockProducts = [\n        { id: '1', soldCount: 1000 },\n        { id: '2', soldCount: 900 },\n        { id: '3', soldCount: 800 },\n      ] as Product[];\n\n      (mockRepository.find as jest.Mock).mockResolvedValue(mockProducts);\n\n      const result = await productRepository.findTopSelling(10);\n\n      expect(result).toEqual(mockProducts);\n    });\n\n    it('should limit results to specified count', async () => {\n      const mockProducts = [\n        { id: '1', soldCount: 1000 },\n        { id: '2', soldCount: 900 },\n      ] as Product[];\n\n      (mockRepository.find as jest.Mock).mockResolvedValue(mockProducts);\n\n      await productRepository.findTopSelling(5);\n\n      expect(mockRepository.find).toHaveBeenCalledWith(\n        expect.objectContaining({\n          take: 5,\n        })\n      );\n    });\n  });\n\n  describe('findTopRated', () => {\n    it('should find top rated products', async () => {\n      const mockProducts = [\n        { id: '1', rating: 4.9, reviewCount: 100 },\n        { id: '2', rating: 4.8, reviewCount: 150 },\n      ] as Product[];\n\n      (mockRepository.find as jest.Mock).mockResolvedValue(mockProducts);\n\n      const result = await productRepository.findTopRated(10);\n\n      expect(result).toEqual(mockProducts);\n    });\n\n    it('should only include products with minimum reviews', async () => {\n      await productRepository.findTopRated(10, 5);\n\n      expect(mockRepository.find).toHaveBeenCalled();\n    });\n  });\n});\n"],"version":3}