{"file":"C:\\Adaptive_Testing\\src\\libs\\validation\\validator.ts","mappings":"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","names":[],"sources":["C:\\Adaptive_Testing\\src\\libs\\validation\\validator.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport { z, ZodError, ZodSchema } from 'zod';\nimport { ValidationError as CustomValidationError } from '../errors';\n\n/**\n * Common validation schemas\n */\nexport const commonSchemas = {\n  // Email validation\n  email: z.string().email('Invalid email format'),\n\n  // UUID validation\n  uuid: z.string().uuid('Invalid UUID format'),\n\n  // Password validation (matches password.utils requirements)\n  password: z\n    .string()\n    .min(8, 'Password must be at least 8 characters')\n    .regex(/[A-Z]/, 'Password must contain at least one uppercase letter')\n    .regex(/[a-z]/, 'Password must contain at least one lowercase letter')\n    .regex(/[0-9]/, 'Password must contain at least one number')\n    .regex(/[!@#$%^&*(),.?\":{}|<>]/, 'Password must contain at least one special character'),\n\n  // Pagination\n  pagination: z.object({\n    page: z.coerce.number().int().positive().default(1),\n    limit: z.coerce.number().int().positive().max(100).default(20),\n  }),\n\n  // Date range\n  dateRange: z.object({\n    startDate: z.coerce.date(),\n    endDate: z.coerce.date(),\n  }),\n\n  // Search query\n  search: z.object({\n    q: z.string().min(1).max(100),\n  }),\n};\n\n/**\n * Middleware factory for validating request data\n */\nexport const validate = (schema: ZodSchema, source: 'body' | 'query' | 'params' = 'body') => {\n  return (req: Request, _res: Response, next: NextFunction): void => {\n    try {\n      const data = req[source];\n      const validated = schema.parse(data);\n\n      // Replace request data with validated data (includes defaults and transformations)\n      req[source] = validated;\n\n      next();\n    } catch (error) {\n      if (error instanceof ZodError) {\n        const errors: Record<string, string[]> = {};\n\n        error.errors.forEach((err) => {\n          const path = err.path.join('.');\n          if (!errors[path]) {\n            errors[path] = [];\n          }\n          errors[path].push(err.message);\n        });\n\n        next(new CustomValidationError('Validation failed', errors));\n      } else {\n        next(error);\n      }\n    }\n  };\n};\n\n/**\n * Validate data programmatically (not as middleware)\n */\nexport const validateData = <T>(schema: ZodSchema<T>, data: unknown): T => {\n  try {\n    return schema.parse(data);\n  } catch (error) {\n    if (error instanceof ZodError) {\n      const errors: Record<string, string[]> = {};\n\n      error.errors.forEach((err) => {\n        const path = err.path.join('.');\n        if (!errors[path]) {\n          errors[path] = [];\n        }\n        errors[path].push(err.message);\n      });\n\n      throw new CustomValidationError('Validation failed', errors);\n    }\n    throw error;\n  }\n};\n\n/**\n * Safe parse - returns result without throwing\n */\nexport const safeParse = <T>(\n  schema: ZodSchema<T>,\n  data: unknown\n): { success: true; data: T } | { success: false; errors: Record<string, string[]> } => {\n  try {\n    const result = schema.parse(data);\n    return { success: true, data: result };\n  } catch (error) {\n    if (error instanceof ZodError) {\n      const errors: Record<string, string[]> = {};\n\n      error.errors.forEach((err) => {\n        const path = err.path.join('.');\n        if (!errors[path]) {\n          errors[path] = [];\n        }\n        errors[path].push(err.message);\n      });\n\n      return { success: false, errors };\n    }\n    return { success: false, errors: { _general: ['Unknown validation error'] } };\n  }\n};\n"],"version":3}